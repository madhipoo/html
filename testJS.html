<!DOCTYPE html>

<html>

<head>
<style>
#info {
		position: absolute;
    width: 100%;
		font-family: Monospace;
		font-size: 20px;
		padding: 5px;
		text-align: center;
		color: #003333;
}


body {
  overflow: hidden;
}


</style>
</head>

<body> 
  <audio crossorigin="anonymous" id="collisionsound" style="display:none">
    <source src="https://madhipoo.github.io/html/music/Taiko drum(Bass drum).mp3" type="audio/wav">
    </audio>
    <audio crossorigin="anonymous2" id="collisionsound2" style="display:none">
    <source src="https://yang880529.github.io/music/Taiko_Drums_Small_Drum.mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound3" style="display:none">
    <source src="https://madhipoo.github.io/html/music/Crash Cymbals.mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound4" style="display:none">
    <source src="https://yang880529.github.io/music/Cymbals_side.mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound5" style="display:none">
    <source src="https://madhipoo.github.io/html/music/Small drum.mp3" type="audio/wav">
    </audio>
    <audio id="soundtrack" autoplay="" loop="" style="display:none">
    <source src="https://madhipoo.github.io/html/music/東京盆踊2020.mp3" type="audio/mp3">
    </audio>
    <audio id="soundtrack2" autoplay="" loop="" style="display:none">
    <source src="https://yang880529.github.io/music/2.mp3" type="audio/mp3">
    </audio>
    <audio id="soundtrack3" autoplay="" loop="" style="display:none">
    <source src="https://madhipoo.github.io/html/music/Aint it fun.mp3" type="audio/mp3">
    </audio>
    <audio id="collisionsound6" style="display:none">
    <source src="https://yang880529.github.io/music/G(1).mp3"type="audio/wav">
    </audio>
    <audio id="collisionsound7" style="display:none">
    <source src="https://yang880529.github.io/music/B(3).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound8" style="display:none">
    <source src="https://yang880529.github.io/music/C(4).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound9" style="display:none">
    <source src="https://yang880529.github.io/music/D(5).mp3"type="audio/wav">
    </audio>
    <audio id="collisionsound10" style="display:none">
    <source src="https://yang880529.github.io/music/E(6).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound11" style="display:none">
    <source src="https://yang880529.github.io/music/F(7).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound12" style="display:none">
    <source src="https://yang880529.github.io/music/G(8).mp3"type="audio/wav">
    </audio>
    <audio id="collisionsound13" style="display:none">
    <source src="https://yang880529.github.io/music/A(9).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound14" style="display:none">
    <source src="https://yang880529.github.io/music/B(10).mp3" type="audio/wav">
    </audio>
    <audio id="collisionsound15" style="display:none">
    <source src="https://yang880529.github.io/music/C(11).mp3" type="audio/wav">
    </audio>
<div id="info">
</div>
<script src="https://threejs.org/build/three.min.js"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

<script type='module'>
import * as THREE from "https://threejs.org/build/three.module.js";
import {TrackballControls}from "https://threejs.org/examples/jsm/controls/TrackballControls.js";
var camera, scene, renderer,controls;
var k = 5,angle = 0;
var opc = 0.5;
const L = 300;
var kk = 8,min = 100;
var GroupA,GroupB,GroupC,GroupD,GroupE,GroupF;
var CubeWorld;
var pos1 = [], pos2 = [], euler1 = [], euler2 = [],quat1 = [],quat2 = [];
var moving;
var turning,change,alpha = [],manIn ='A';
var people = [],car = [],piano = [];
var musicbox;
var lastChangeTime = 0;
var keyNow='A';
var faces;
var angle=0,test = 0,count = 0;

var Drumpose1 = {
        Dtheta1: 1.2057796021989051,
        Dtheta2: 0,
        Dtheta3: 1.5,
        Dtheta4: 0.6,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.33541054459782915,
        Dtheta10: -0.025268798743482757,
        Dtheta11: 0,
        Dtheta12: 0
	}
var Drumpose2 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.5,
        Dtheta4: 0.3,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.24679861721087304,
        Dtheta10: -0.06957476243696081,
        Dtheta11: 0,
        Dtheta12: 0
}
var Drumpose3 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.5,
        Dtheta4: 0,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: 0.48424978373151495,
        Dtheta10: 0.15,
        Dtheta11: 0,
        Dtheta12: 0.6
}
var Drumpose4 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.5,
        Dtheta4: 1,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: 0.2184140015706466,
        Dtheta10: 0.17410803787716844,
        Dtheta11: 0,
        Dtheta12: 0
}
var Drumpose5 = {
        Dtheta1: 1.2057796021989051,
        Dtheta2: 0,
        Dtheta3: 1.5,
        Dtheta4: 0.6,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.33541054459782915,
        Dtheta10: -0.025268798743482757,
        Dtheta11: 0,
        Dtheta12: 0
}
var Drumpose6 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.09501469296521,
        Dtheta4: 0,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: 0.48424978373151495,
        Dtheta10: 0.08549611049021233,
        Dtheta11: 0,
        Dtheta12: 0
}
var Drumpose7 = {
        Dtheta1: 1.5,
        Dtheta2: 0,
        Dtheta3: 1.5,
        Dtheta4: 1,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.33541054459782915,
        Dtheta10: -0.15,
        Dtheta11: -0.6,
        Dtheta12: 0
}
var Drumpose8 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.5,
        Dtheta4: 1,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.24679861721087304,
        Dtheta10: -0.06957476243696081,
        Dtheta11: 0,
        Dtheta12: 0
}

var Drumpose11 = {
        Dtheta1: 1.2057796021989051,
        Dtheta2: 0,
        Dtheta3: 1.5,
        Dtheta4: 0.6,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: -0.33541054459782915,
        Dtheta10: -0.025268798743482757,
        Dtheta11: 0,
        Dtheta12: 0
	}
var Drumpose12 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.2057796021989051,
        Dtheta4: 0,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: 0.48424978373151495,
        Dtheta10: 0.08549611049021233,
        Dtheta11: 0,
        Dtheta12: 0
}
var Drumpose13 = {
        Dtheta1: 1.5,
        Dtheta2: 1,
        Dtheta3: 1.5,
        Dtheta4: 1,
        Dtheta5: 0,
        Dtheta6: 0,
        Dtheta7: 0,
        Dtheta8: 0,
        Dtheta9: 0,
        Dtheta10: 0,
        Dtheta11: 0,
        Dtheta12: 0
}

var Cymbalpose1 = {
        Ctheta1: 0.7,
        Ctheta2: 1,
        Ctheta3: 0.7,
        Ctheta4: 1,
        Ctheta5: 0,
        Ctheta6: 0,
        Ctheta7: 0,
        Ctheta8: 0,
        Ctheta9: 0,
        Ctheta10: 0,
        Ctheta11: 0.7300855658923833,
        Ctheta12:  -0.7300855658923833,
}//合
var Cymbalpose2 = {
        Ctheta1: 0.7,
        Ctheta2: 1,
        Ctheta3: 0.7,
        Ctheta4: 1,
        Ctheta5: 0,
        Ctheta6: 0,
        Ctheta7: 0,
        Ctheta8: 0,
        Ctheta9: 0,
        Ctheta10: 0,
        Ctheta11: 0,
        Ctheta12: 0
}//開

var Smallpose1 = {
        Stheta1: 1.2,
        Stheta2: 0.4,
        Stheta3: 1.2,
        Stheta4: 0.4,
        Stheta5: 0,
        Stheta6: 0,
        Stheta7: 0,
        Stheta8: 0,
        Stheta9: -0.33541054459782915,
        Stheta10: -0.025268798743482757,
        Stheta11: -1.903427398586418,
        Stheta12: -1.202492653517395,
        Stheta13: 0,
        Stheta14: -1.7341642178391317
	}
var Smallpose2 = {
  Stheta1: 1.2,
  Stheta2: 0.4,
  Stheta3: 1.2,
  Stheta4: 0.4,
  Stheta5: 0,
  Stheta6: 0,
  Stheta7: 0,
  Stheta8: 0,
  Stheta9: -0.24679861721087304,
  Stheta10: -0.06957476243696081,
  Stheta11: -1.903427398586418,
  Stheta12: -1.202492653517395,
  Stheta13: 0.797507346482605,
  Stheta14: -1.1581866898239168
}
var Smallpose3 = {
        Stheta1: 1.2,
        Stheta2: 0.4,
        Stheta3: 1.2,
        Stheta4: 0.4,
        Stheta5: 0,
        Stheta6: 0,
        Stheta7: 0,
        Stheta8: 0,
        Stheta9: 0.48424978373151495,
        Stheta10: 0.08549611049021233,
        Stheta11: -1.903427398586418,
        Stheta12: -1.202492653517395,
        Stheta13: 1.7357796021989051,
        Stheta14: 0
}

var Pmanpose1 = {
        Pmtheta1: 0.3,
        Pmtheta2: 0.5,
        Pmtheta3: 0.3,
        Pmtheta4: 0.5,
        Pmtheta5: 0,
        Pmtheta6: 0,
        Pmtheta7: 0,
        Pmtheta8: 0,
        Pmtheta9: 0,
        Pmtheta10: -0.3,
        Pmtheta11: 1,
        Pmtheta12: -1
	}
var Pmanpose2 = {
        Pmtheta1: 0.1,
        Pmtheta2: 0.3,
        Pmtheta3: 0.1,
        Pmtheta4: 0.3,
        Pmtheta5: 0,
        Pmtheta6: 0,
        Pmtheta7: 0,
        Pmtheta8: 0,
        Pmtheta9: 0,
        Pmtheta10: 0,
        Pmtheta11: 0.9,
        Pmtheta12: -0.9
}
var Pmanpose3 = {
        Pmtheta1: 0.3,
        Pmtheta2: 0.5,
        Pmtheta3: 0.3,
        Pmtheta4: 0.5,
        Pmtheta5: 0,
        Pmtheta6: 0,
        Pmtheta7: 0,
        Pmtheta8: 0,
        Pmtheta9: 0,
        Pmtheta10: 0.3,
        Pmtheta11: 1,
        Pmtheta12: -1
}
var Pmanpose4 = {
        Pmtheta1: 0.5,
        Pmtheta2: 0.8,
        Pmtheta3: 0.5,
        Pmtheta4: 0.8,
        Pmtheta5: 0,
        Pmtheta6: 0,
        Pmtheta7: 0,
        Pmtheta8: 0,
        Pmtheta9: 0,
        Pmtheta10: 0,
        Pmtheta11: 1,
        Pmtheta12: -1
}

var pose41 = {
        theta1: 0.2,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
	}
var pose42 = {
        theta1: 0,
        theta2: 0.2,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose43 = {
        theta1: 0,
        theta2: 0,
        theta3: 0.2,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose44 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0.2,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose45 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0.2,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose46 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0.2,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose47 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0.2,
        theta8: 0,
        theta9: 0,
        theta10: 0
}
var pose48 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0.2,
        theta9: 0,
        theta10: 0
}
var pose49 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0.2,
        theta10: 0
	}
var pose50 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0.2
	}
var pose51 = {
        theta1: 0,
        theta2: 0,
        theta3: 0,
        theta4: 0,
        theta5: 0,
        theta6: 0,
        theta7: 0,
        theta8: 0,
        theta9: 0,
        theta10: 0
	}

var Smallkeys = [
  [0, Smallpose3],
  [0.09375, Smallpose1],
  [0.21875, Smallpose3],
  [0.34375, Smallpose1],
  [0.46875, Smallpose3],
  [0.5, Smallpose1],
  [0.59375, Smallpose3],
  [0.71875, Smallpose1],
  [0.84375, Smallpose3],
  [0.96875, Smallpose1],
  [1, Smallpose3]
];
var Smallkeys2 = [
  [0, Smallpose2],
  [0.046875, Smallpose1],
  [0.109375, Smallpose3],
	[0.140625, Smallpose1],
  [0.171875, Smallpose3],
  [0.203125, Smallpose1],
  [0.296875, Smallpose3],
  [0.359375, Smallpose1],
	[0.390625, Smallpose3],
  [0.421875, Smallpose1],
  [0.453125, Smallpose3],
  [0.546875, Smallpose1],
  [0.609375, Smallpose3],
	[0.640625, Smallpose1],
  [0.671875, Smallpose3],
  [0.703125, Smallpose1],
  [0.765625, Smallpose3],
  [0.859375, Smallpose1],
	[0.890625, Smallpose3],
  [0.921875, Smallpose1],
  [0.953125, Smallpose3],
  [1, Smallpose2]
];

var Cymbalkeys = [
  [0, Cymbalpose1],
  [0.125,Cymbalpose2],
  [0.3125, Cymbalpose1],
  [0.5,Cymbalpose2],
  [0.8125,Cymbalpose1],
  [0.9,Cymbalpose2],
  [1, Cymbalpose1]
];
var Cymbalkeys2 = [
  [0, Cymbalpose2],
  [0.015625,Cymbalpose1],
  [0.078125,Cymbalpose2],
  [0.140625,Cymbalpose1],
  [0.203125,Cymbalpose2],
  [0.265625,Cymbalpose1],
  [0.328125,Cymbalpose2],
  [0.390625,Cymbalpose1],
  [0.453125,Cymbalpose2],
  [0.515625,Cymbalpose1],
  [0.578125,Cymbalpose2],
  [0.640625,Cymbalpose1],
  [0.703125,Cymbalpose2],
  [0.765625,Cymbalpose1],
  [0.828125,Cymbalpose2],
  [0.890625,Cymbalpose1],
  [0.90625,Cymbalpose2],
	[0.921875,Cymbalpose1],
  [0.9375,Cymbalpose2],
  [0.953125,Cymbalpose1],
  [1, Cymbalpose2]
];

var Drumkeys = [
  [0, Drumpose8],
  [0.0625, Drumpose1],
  [0.1875, Drumpose3],
  [0.3125, Drumpose5],
  [0.3750, Drumpose6],
  [0.4375, Drumpose7],
  [0.5675, Drumpose6],
  [0.7, Drumpose7],
  [0.8125, Drumpose6],
  [0.8750, Drumpose5],
  [0.9375, Drumpose3],
  [1, Drumpose8]
];
var Drumkeys2 = [
  [0, Drumpose13],
  [0.015625,Drumpose11],
  [0.140625,Drumpose12],
  [0.265625,Drumpose11],
  [0.390625,Drumpose12],
  [0.515625,Drumpose11],
  [0.640625,Drumpose12],
  [0.765625,Drumpose11],
  [0.890625,Drumpose12],
  [1, Drumpose13]
];

var Pmankeys = [
  [0, Pmanpose1],
  [0.125, Pmanpose4],
  [0.250, Pmanpose3],
  [0.375, Pmanpose2],
  [0.5, Pmanpose1],
  [0.625, Pmanpose4],
  [0.750, Pmanpose3],
  [0.875, Pmanpose2],
  [1, Pmanpose1]
];
var keys5 = [
  [0, pose43],
  [0.0078125, pose51],
  [0.015625, pose43],
  [0.03125, pose41],
  [0.046875, pose43],
  [0.0625, pose45],
  [0.078125, pose43],
  [0.09375, pose45],
  [0.109375, pose47],
  [0.125, pose43],
  [0.140625, pose50],
  [0.15625, pose49],
  [0.171875, pose48],
  [0.1875, pose47],
  [0.203125, pose51],
  [0.21875, pose51],
  [0.234375, pose51],
  [0.25, pose47],
  [0.2578125, pose51],
  [0.265625, pose47],
  [0.28125, pose46],
  [0.296875, pose44],
  [0.3125, pose42],
  [0.328125, pose41],
  [0.34375, pose42],
  [0.359375, pose44],
  [0.375, pose46],
  [0.390625, pose45],
  [0.40625, pose43],
  [0.421875, pose48],
  [0.4375, pose47],
  [0.453125, pose51],
  [0.46875, pose51],
  [0.484375, pose51],
  [0.5, pose43],
  [0.5078125, pose51],
  [0.515625, pose43],
  [0.53125, pose41],
  [0.546875, pose43],
  [0.5625, pose45],
  [0.578125, pose43],
  [0.59375, pose45],
  [0.609375, pose47],
  [0.625, pose43],
  [0.640625, pose50],
  [0.65625, pose49],
  [0.671875, pose48],
  [0.6875, pose47],
  [0.703125, pose51],
  [0.71875, pose51],
  [0.734375, pose51],
  [0.75, pose43],
  [0.765625, pose47],
  [0.78125, pose46],
  [0.796875, pose44],
  [0.8125, pose42],
  [0.828125, pose41],
  [0.84375, pose42],
  [0.859375, pose44],
  [0.875, pose42],
  [0.890625, pose43],
  [0.90625, pose41],
  [0.921875, pose45],
  [0.9375, pose43],
  [0.953125, pose51],
  [0.96875, pose51],
  [0.984375, pose51],
  [1, pose43]
];

var T,T2;
var clock = new THREE.Clock();
var ts = clock.getElapsedTime();  // start time
var intKey = [],intKey1 = [],intKey2 = [],intKey3 = [],intKey4 = [],intKey5 = [];
var soundTrack,soundTrack2,soundTrack3,collisionSound = [];
var isDimming = false, soundVal = 0, sign = 1.0,soundVal2 = 0,soundVal3 = 0,b=1;
var Pianokeys;
(function() {
  Math.clamp = function(val,min,max){
    return Math.min(Math.max(val,min),max);
    
  }})();



init();
animate();

function init() {
	soundTrack = document.getElementById ('soundtrack');
  soundTrack2 = document.getElementById ('soundtrack2');
  soundTrack3 = document.getElementById ('soundtrack3');
  collisionSound[1] = document.getElementById('collisionsound');
  //collisionsound.crossOrigin="anonymous";
  collisionSound[2] = document.getElementById ('collisionsound2');
  //collisionSound2.crossOrigin="anonymous";
 	collisionSound[3] = document.getElementById ('collisionsound3');
  collisionSound[4] = document.getElementById ('collisionsound4');
  collisionSound[5] = document.getElementById ('collisionsound5');
  collisionSound[6] = document.getElementById ('collisionsound6');
  collisionSound[7]= document.getElementById ('collisionsound7');
  collisionSound[8] = document.getElementById ('collisionsound8');
  collisionSound[9] = document.getElementById ('collisionsound9');
  collisionSound[10] = document.getElementById ('collisionsound10');
  collisionSound[11] = document.getElementById ('collisionsound11');
  collisionSound[12] = document.getElementById ('collisionsound12');
  collisionSound[13] = document.getElementById ('collisionsound13');
  collisionSound[14] = document.getElementById ('collisionsound14');
  collisionSound[15] = document.getElementById ('collisionsound15');
  scene = new THREE.Scene();

  renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setClearColor(0x888888);
  document.body.appendChild(renderer.domElement);

  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
  camera.position.z = 500;

  controls = new TrackballControls(camera, renderer.domElement);
	controls.rotateSpeed =2.0;
  controls.roomSpeed =1.2;
  controls.panSpeed =0.8;
  ////////////////////////////////////////////////////////////////
  /*var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
  scene.add(gridXZ);*/
	CubeWorld = new THREE.Group();
	GroupA = new THREE.Group();
  CubeWorld.add(GroupA);
  
  people[0] = buildDrumMan();
  car[0] = buildcar();
  people[0][0].position.set(0,10,0);
  car[0].add(people[0][0]);
  car[0].rotation.y = Math.PI/2;
  GroupA.add(car[0]);
  GroupA.children[0].position.copy (new THREE.Vector3(0,0,0));
  GroupA.children[0].rotation.copy (new THREE.Euler(0, Math.PI/2, 0, 'ZYX'));
  var circlegeometry = new THREE.CircleBufferGeometry( 1, 32 );
	var circlematerial = new THREE.MeshBasicMaterial( { color: 'red',side:THREE.DoubleSide});
  let circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupA.add(circle);
  
  let drum = buildDrum();
  drum.rotation.y = Math.PI/2;
  GroupA.add(drum);
  
  let floorA = buildBackground();
  GroupA.add(floorA);
  GroupA.rotation.x = Math.PI/2;
  GroupA.position.z = L/2;
  let pointA = buildPointer();
  GroupA.add(pointA);
  pointA.rotation.y = -Math.PI/2;
  pointA.position.set(80,0.2,0);
  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/vK0CXzl.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaTest: 0.5,
    transparent: true,
    side: THREE.DoubleSide
  });
  let taigo = new THREE.Mesh(new THREE.PlaneGeometry(240,200), texMat);
  taigo.rotation.x=-Math.PI/2;
  taigo.position.y=0.03;
  GroupA.add(taigo);
  GroupA.children[5].visible = false;
  ////////////////////////////////////////
  GroupB = new THREE.Group();
  CubeWorld.add(GroupB);
  
  people[1] = buildCymbalMan();
  car[1] = buildcar();
  people[1][0].position.set(0,10,0);
  car[1].add(people[1][0]);
  car[1].rotation.y = Math.PI;
  GroupB.add(car[1]);
  
  circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupB.add(circle);

  let floorB = buildBackground();
  GroupB.add(floorB);
  GroupB.position.x = L/2;
  GroupB.rotation.z = -Math.PI/2;
  GroupB.children[0].position.set(0,- L/2, L/2);
  GroupB.children[0].rotation.copy(new THREE.Euler (-Math.PI/2, Math.PI, 0, 'ZYX'));
  let pointB = buildPointer();
  GroupB.add(pointB);
  pointB.position.set(0,0.2,-80);
  texture = loader.load('https://i.imgur.com/DKoClgt.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaTest: 0.5,
    transparent: true,
    side: THREE.DoubleSide
  });
  let tonba = new THREE.Mesh(new THREE.PlaneGeometry(240,200), texMat);
  tonba.rotation.z=Math.PI/2;
  tonba.rotation.x=-Math.PI/2;
  tonba.position.y=0.03;
  GroupB.add(tonba);
  ////////////////////////////////////////
  GroupC = new THREE.Group();
  CubeWorld.add(GroupC);
  
  people[2] = buildSmalldrumMan();
  car[2] = buildcar();
  people[2][0].position.set(0,10,0);
  car[2].add(people[2][0]);
  car[2].rotation.y = -Math.PI/2;
  GroupC.add(car[2]);
  GroupC.children[0].position.set(0,-L, 0);
  GroupC.children[0].rotation.copy(new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX'));
  circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupC.add(circle);

  let floorC = buildBackground();
  GroupC.add(floorC);
  GroupC.rotation.x = -Math.PI/2;
  GroupC.position.z = -L/2;
  let pointC = buildPointer();
  GroupC.add(pointC);
  pointC.rotation.y = Math.PI/2;
  pointC.position.set(-80,0.2,0);
  texture = loader.load('https://i.imgur.com/bSbIyhB.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaTest: 0.5,
    transparent: true,
    side: THREE.DoubleSide
  });
  let siogo = new THREE.Mesh(new THREE.PlaneGeometry(200,200), texMat);
  siogo.rotation.x=Math.PI/2;
  siogo.position.y=0.03;
  GroupC.add(siogo);
  ////////////////////////////////////////
  GroupD = new THREE.Group();
  CubeWorld.add(GroupD);
  
  circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupD.add(circle);

  let floorD = buildBackground();
  GroupD.add(floorD);
  GroupD.rotation.z = Math.PI/2;
  GroupD.position.x = -L/2;
  
  loader = new THREE.TextureLoader();

  // load a resource
  loader.load(
    // resource URL
    'https://i.imgur.com/3GKmjuK.png',
    // Function when resource is loaded
    function(texture) {
      // do something with the texture
      // Plane with default texture coordinates [0,1]x[0,1]
      var texMat = new THREE.MeshBasicMaterial({
        map: texture,
        alphaTest: 0.5
      });
      let mesh = new THREE.Mesh(buildLogo(), texMat);
      GroupD.add(mesh);
      GroupD.children[2].position.set(0,0.02,0);
      GroupD.children[2].rotation.set(-Math.PI/2,0,-Math.PI/2);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
    }
  );
  ////////////////////////////////////////
  GroupE = new THREE.Group();
  CubeWorld.add(GroupE);
  
  people[4] = buildpianoMan();
  car[4] = buildcar();
  people[4][0].position.set(0,10,0);
  car[4].add(people[4][0]);
  car[4].rotation.y = Math.PI/2;
  GroupE.add(car[4]);
  GroupE.children[0].position.set(0,-L/2, L/2);
  GroupE.children[0].rotation.copy(new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX'));
  
  
  circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupE.add(circle);

  let floorE = buildBackground();
  GroupE.add(floorE);
  GroupE.position.y = L/2;
  let drum2 = buildDrum();
  drum2.rotation.y = Math.PI/2;
  drum2.position.set(-100,0,68);
  GroupE.add(drum2);
  piano = buildpiano();
  piano[0].rotation.y = Math.PI/2;
  piano[0].position.set(5,20,-38);
  piano[1].rotation.x-=Math.PI*9/8;
  piano[2].rotation.x=-Math.PI/2;
  GroupE.add(piano[0]);
  let pointE = buildPointer();
  GroupE.add(pointE);
  pointE.rotation.y = -Math.PI/2;
  pointE.position.set(80,0.2,0);
  texture = loader.load('https://i.imgur.com/lnnkqyd.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaTest: 0.5,
    transparent: true,
    side: THREE.DoubleSide
  });
  let jihoy = new THREE.Mesh(new THREE.PlaneGeometry(200,200), texMat);
  jihoy.rotation.z=Math.PI/2;
  jihoy.rotation.x=-Math.PI/2;
  jihoy.position.y=0.03;
  GroupE.add(jihoy);
   ////////////////////////////////////////
  GroupF = new THREE.Group();
  CubeWorld.add(GroupF);
  
  circle = new THREE.Mesh( circlegeometry, circlematerial );
  circle.rotation.x=-Math.PI/2;
  circle.position.y=1;
  GroupF.add(circle);

  let floorF = buildBackground();
  GroupF.add(floorF);
  GroupF.rotation.x = Math.PI;
  GroupF.position.y = -L/2;
  
  loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  texture = loader.load('https://i.imgur.com/v51N88A.png');
  alpha = loader.load('https://i.imgur.com/zZsPHVR.png');

  var texMat = new THREE.MeshBasicMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  let word = new THREE.Mesh(new THREE.PlaneGeometry(300,300), texMat);
  word.rotation.x-=Math.PI/2;
  word.position.y=0.1;
  GroupF.add(word);
  //////////////////////////////////////
	CubeWorld.add (new THREE.AxesHelper (L/5));
  scene.add(CubeWorld);
  var edgegeometry = new THREE.BoxBufferGeometry( L, L, L );
  var edgematerial = new THREE.MeshBasicMaterial( {color: 0xff0000} );
  let cube = new THREE.Mesh( edgegeometry, edgematerial );
  let edges = new THREE.EdgesHelper(  cube, 0x0000ff );//設定邊框，可以旋轉

  scene.add( edges );
  ////// create positionaudio
  var listener = new THREE.AudioListener();
  listener.crossOrigin = "anonymous";
  var listener2 = new THREE.AudioListener();
  listener2.crossOrigin = "anonymous2";
  camera.add(listener,listener2);

  musicbox = new THREE.BoxGeometry(2,1,5);
  let thebox = new THREE.Mesh(musicbox,new THREE.MeshNormalMaterial());
  thebox.rotation.y=Math.PI;


  faces = {'B': GroupB.children[0], 'E':GroupE.children[0],'A':GroupA.children[0],'D':GroupD.children[0],'F':GroupF.children[0],'C':GroupC.children[0]};
}

function buildDrum(){
	let box = new THREE.Group();
  var loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  var colormap = loader.load ('https://i.imgur.com/MTtMccq.jpg');
  var points = [];
  for ( var i = 0; i < 10; i ++ ) {
    points.push( new THREE.Vector2( Math.sin( i * 0.2 ) * 2 + 18, ( i - 5 ) * 2 ) );
  }
  var geometry = new THREE.LatheGeometry( points );
  var material = new THREE.MeshLambertMaterial( { map: colormap} );
  var lathe1 = new THREE.Mesh( geometry, material );
  lathe1.rotation.z=Math.PI/2;
  lathe1.position.set(48,45,0);
  scene.add( lathe1 );
  for ( var i = 0; i < 10; i ++ ) {
    points.push( new THREE.Vector2( Math.sin( i * 0.2 ) * 2 + 18, ( i - 5 ) * 2 ) );
  }

  var lathe2 = new THREE.Mesh( geometry, material );
  lathe2.rotation.z=-Math.PI/2;
  lathe2.position.set(33,45,0);
  scene.add( lathe2 );


  var geometry = new THREE.CylinderBufferGeometry(18, 18, 1, 64 );
  var material = new THREE.MeshLambertMaterial( {color: 0xeba434} );
  let cylinder2 = new THREE.Mesh( geometry, material );
  cylinder2.position.set(23,45,0);
  cylinder2.rotation.z=-Math.PI/2;
  let cylinder3 = new THREE.Mesh( geometry, material );
  cylinder3.position.set(58,45,0);
  cylinder3.rotation.z=-Math.PI/2;
  var loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  var colormap = loader.load ('https://i.imgur.com/rMKI0rA.jpg');
  var geometry = new THREE.CylinderBufferGeometry(1, 1, 50, 32 );
  var material = new THREE.MeshLambertMaterial( {map: colormap} );
  let cylinder4 = new THREE.Mesh( geometry, material );
  cylinder4.position.set(51,18,0);
  cylinder4.rotation.x=-Math.PI/4;
  let cylinder5 = new THREE.Mesh( geometry, material );
  cylinder5.position.set(51,18,0);
  cylinder5.rotation.x=Math.PI/4;
  let cylinder6 = new THREE.Mesh( geometry, material );
  cylinder6.position.set(30,18,0);
  cylinder6.rotation.x=-Math.PI/4;
  let cylinder7 = new THREE.Mesh( geometry, material );
  cylinder7.position.set(30,18,0);
  cylinder7.rotation.x=Math.PI/4;
  
  let texture = loader.load('https://i.imgur.com/XQP0bm3.png');
  let alpha = loader.load('https://i.imgur.com/rf4FmX5.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  var shadow = new THREE.Mesh(new THREE.PlaneGeometry(50,50), texMat);
  shadow.rotation.set(Math.PI/2,0,Math.PI/2);
  shadow.position.set(50,0.1,0);
  
  box.add(lathe1,lathe2,cylinder2,cylinder3,cylinder4,cylinder5,cylinder6,cylinder7,shadow);
  
  return box;
  }
function buildDrumMan(){
  let man = new THREE.Group();
	//GroupA.add(mine);
	let head = makeDrumHead();
	let torso = makeDrumTorso();
	man.add(torso);
	head.position.y = 7.57*k-4.09*k;
	torso.position.y = 4.09*k;
	torso.add(head);

	let leftarm = makeDrumArm();
	leftarm[0].position.set (-1.88*k, 7.57*k-4.09*k, 0);
	leftarm[0].add(leftarm[1]);
	torso.add (leftarm[0]);
	let rightarm = makeDrumArm();
	rightarm[0].position.set (1.88*k, 7.57*k-4.09*k, 0);
	rightarm[0].add(rightarm[1]);
	torso.add(rightarm[0]);


	let leftleg = makeDrumLeg();
	leftleg[0].position.set  (-0.63*k, 4.09*k-4.09*k, 0);
	leftleg[0].add(leftleg[1]);
	torso.add(leftleg[0]);


	let rightleg = makeDrumLeg();
	rightleg[0].position.set (0.63*k, 4.09*k-4.09*k, 0);
	rightleg[0].add(rightleg[1]);
	torso.add(rightleg[0]);

	man.rotation.y=-Math.PI/2;	
	man.position.y=0.01;
	leftarm[0].rotation.z = -Math.PI/2;
	rightarm[0].rotation.z = -Math.PI/2;
	leftleg[0].rotation.z = -Math.PI/2;
	rightleg[0].rotation.z = -Math.PI/2;
	
  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/XQP0bm3.png');
  let alpha = loader.load('https://i.imgur.com/XeDC2uO.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  var shadow = new THREE.Mesh(new THREE.PlaneGeometry(80,80), texMat);
  shadow.rotation.x=Math.PI/2;
  shadow.position.z=6.5;
  shadow.position.y=-9;
  man.add(shadow);
  
	leftarm[0].rotation.order = 'ZYX';
	rightarm[0].rotation.order = 'ZYX';
	leftleg[0].rotation.order = 'ZYX';
	rightleg[0].rotation.order = 'ZYX';
  man.rotation.order = 'ZYX';
  return [man,head,torso,leftarm[0],leftarm[1],rightarm[0],rightarm[1],leftleg[0],leftleg[1],rightleg[0],rightleg[1],leftarm[2],rightarm[2],shadow];
}
function makeDrumArm() {
	var group = new THREE.Group();
 	var group2 = new THREE.Group();
  var geometry = new THREE.CylinderBufferGeometry(1, 1, 10, 32 );
  var material = new THREE.MeshBasicMaterial( {color: 0x803d0a} );
  let stick= new THREE.Mesh( geometry, material );
  let body3=buildDrumarm();
  body3.rotation.z=Math.PI/2;
  body3.position.x = 1.92*k;
  let body6=buildDrumarm2();
  body6.rotation.z=Math.PI/2;
  body6.position.x = 1.92*k;
  stick.position.set(2*k,0,-5);
  stick.rotation.x=Math.PI/2;
  group2.add(stick,body6);
  group.add (group2,body3);
  group2.position.x =2*k;

	return [group,group2,stick];
}
function makeDrumLeg() {
	var group = new THREE.Group();
  var group2 = new THREE.Group();
  
  let body7=buildDrumleg();
  body7.rotation.z=Math.PI/2;
  body7.position.x = 2.046*k;
  let body8=buildDrumleg2();
  body8.rotation.z=Math.PI/2;
  body8.position.x = 2.046*k;
  group2.add(body8);
	group.add (group2,body7);
  group2.position.x =2.045*k;

	return [group,group2];
}
function makeDrumHead() {
	var headGroup = new THREE.Group();
  let headBody2=buildDrumface();
  headBody2.rotation.y=Math.PI;
	headGroup.add (headBody2);
	return headGroup;
}
function makeDrumTorso () {
	var group = new THREE.Group();
  let Torsobody2=buildDrumTorso();
  Torsobody2.rotation.y=Math.PI;
	group.add (Torsobody2);
return group;

}
function buildDrumface() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, -2.53*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/3d2gw9B.png');
  let texture1 = loader.load('https://i.imgur.com/XDyw0Rs.png');
  let texture2 = loader.load('https://i.imgur.com/8oxlNMA.png');
  let texture3 = loader.load('https://i.imgur.com/WjEobnE.png');
  let texture4 = loader.load('https://i.imgur.com/TLdR62i.png');
  let texture5 = loader.load('https://i.imgur.com/E57CwUJ.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture1
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }),
    new THREE.MeshPhongMaterial({
      map: texture4
    }),
    new THREE.MeshPhongMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildDrumTorso() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/SFPQbvU.png');
  let texture1 = loader.load('https://i.imgur.com/srIZpsC.png');
  let texture2 = loader.load('https://i.imgur.com/zgO9YE0.png');
  let texture3 = loader.load('https://i.imgur.com/srIZpsC.png');
  let texture4 = loader.load('https://i.imgur.com/iADRREk.png');
  let texture5 = loader.load('https://i.imgur.com/ZPH1PVI.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture1
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }),
    new THREE.MeshPhongMaterial({
      map: texture4
    }),
    new THREE.MeshPhongMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildDrumarm() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/GBmTa4L.png');
  let texture2 = loader.load('https://i.imgur.com/xWC8zfg.png');
  let texture3 = loader.load('https://i.imgur.com/eA5BB9i.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildDrumarm2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/eA5BB9i.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildDrumleg() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/HdgeyBu.png');
  let texture2 = loader.load('https://i.imgur.com/6mpD0ol.png');
  let texture3 = loader.load('https://i.imgur.com/eA5BB9i.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildDrumleg2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/4ojGjEo.png');
  let texture2 = loader.load('https://i.imgur.com/eA5BB9i.png');
  let texture3 = loader.load('https://i.imgur.com/Xsw5JHL.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
///////////////////////
function buildCymbalMan(){
  let man = new THREE.Group();
	let head = makeCymbalHead();
	let torso = makeCymbalTorso();
	man.add(torso);
	head.position.y = 7.57*k-4.09*k;
	torso.position.y = 4.09*k;
	torso.add(head);
  var loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  var colormap = loader.load ('https://i.imgur.com/54uWXuj.jpg');
  var geometry = new THREE.CylinderBufferGeometry(5, 10, 1, 32 );
  var material = new THREE.MeshLambertMaterial( {map: colormap} );
  let stick= new THREE.Mesh( geometry, material );
  let stick2= new THREE.Mesh( geometry, material );
  var geometry = new THREE.BoxGeometry(2, 1, 1, 32 );
  var material = new THREE.MeshLambertMaterial( {color: 'red'} );
  let line= new THREE.Mesh( geometry, material );
	let line2= new THREE.Mesh( geometry, material );
  
	let leftarm = makeCymbalArm();
  stick.position.set(2*k,3,0);
  stick.rotation.z+=Math.PI*3/4;
  line.position.set(0,0,0);
  line.rotation.z=Math.PI/4;
	leftarm[0].position.set (-1.88*k, 7.57*k-4.09*k, 0);
	leftarm[0].add(leftarm[1]);
	leftarm[1].add(stick);
  stick.add(line);
	torso.add (leftarm[0]);
  
	let rightarm = makeCymbalArm();
  stick2.position.set(2*k,-3,0);
  stick2.rotation.z=Math.PI/5;
  line2.position.set(0,0,0);
  line2.rotation.z=-Math.PI/4;
	rightarm[0].position.set (1.88*k, 7.57*k-4.09*k, 0);
	rightarm[0].add(rightarm[1]);
	rightarm[1].add(stick2);
  stick2.add(line2);
	torso.add(rightarm[0]);
  
  
	let leftleg = makeCymbalLeg();
	leftleg[0].position.set  (-0.63*k, 4.09*k-4.09*k, 0);
	leftleg[0].add(leftleg[1]);
	torso.add(leftleg[0]);


	let rightleg = makeCymbalLeg();
	rightleg[0].position.set (0.63*k, 4.09*k-4.09*k, 0);
	rightleg[0].add(rightleg[1]);
	torso.add(rightleg[0]);

	man.rotation.y=-Math.PI/2;	
	man.position.y=0.01;
	leftarm[0].rotation.z = -Math.PI/2;
	rightarm[0].rotation.z = -Math.PI/2;
	leftleg[0].rotation.z = -Math.PI/2;
	rightleg[0].rotation.z = -Math.PI/2;
	

  let texture = loader.load('https://i.imgur.com/XQP0bm3.png');
  let alpha = loader.load('https://i.imgur.com/XeDC2uO.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  var shadow = new THREE.Mesh(new THREE.PlaneGeometry(80,80), texMat);
  shadow.rotation.x=Math.PI/2;
  shadow.position.z=6.5;
  shadow.position.y=-9;
  man.add(shadow);
  
	leftarm[0].rotation.order = 'ZYX';
	rightarm[0].rotation.order = 'ZYX';
	leftleg[0].rotation.order = 'ZYX';
	rightleg[0].rotation.order = 'ZYX';
  man.rotation.order = 'ZYX';
  return [man,head,torso,leftarm[0],leftarm[1],rightarm[0],rightarm[1],leftleg[0],leftleg[1],rightleg[0],rightleg[1],stick,stick2,shadow];
}
function makeCymbalArm() {
	var group = new THREE.Group();
 	var group2 = new THREE.Group();
  let body3=buildCymbalarm();
  body3.rotation.z=Math.PI/2;
  body3.position.x = 1.92*k;
  let body8=buildCymbalarm2();
  body8.rotation.z=Math.PI/2;
  body8.position.x = 1.92*k;
  group2.add(body8);
  group.add (group2,body3);
  group2.position.x =2*k;
	return [group,group2];
}
function makeCymbalLeg() {
	var group = new THREE.Group();
  var group2 = new THREE.Group();
  let body7=buildCymballeg();
  body7.rotation.z=Math.PI/2;
  body7.position.x = 2.046*k;
  let body8=buildCymballeg2();
  body8.rotation.z=Math.PI/2;
  body8.position.x = 2.046*k;
  group2.add(body8);
	group.add (group2,body7);
  group2.position.x =2.045*k;

	return [group,group2];
}
function makeCymbalHead() {
	var headGroup = new THREE.Group();
  let headBody2=buildCymbalface();
  headBody2.rotation.y=Math.PI;
	headGroup.add (headBody2);

	return headGroup;
}
function makeCymbalTorso () {
	var group = new THREE.Group();
  let Torsobody2=buildCymbalTorso();
  Torsobody2.rotation.y=Math.PI;
	group.add (Torsobody2);

return group;

}
function buildCymbalface() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, -2.53*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/IYkzEoo.png');
  let texture1 = loader.load('https://i.imgur.com/UyF6RiR.png');
  let texture2 = loader.load('https://i.imgur.com/3vfswFa.png');
  let texture3 = loader.load('https://i.imgur.com/UQYNSe6.png');
  let texture4 = loader.load('https://i.imgur.com/TLdR62i.png');
  let texture5 = loader.load('https://i.imgur.com/E57CwUJ.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture1
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildCymbalTorso() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/Cx06iy5.png');
  let texture1 = loader.load('https://i.imgur.com/X7OW52g.png');
  let texture2 = loader.load('https://i.imgur.com/9DKgJ8s.png');
  let texture3 = loader.load('https://i.imgur.com/X7OW52g.png');
  let texture4 = loader.load('https://i.imgur.com/wXgv152.png');
  let texture5 = loader.load('https://i.imgur.com/9DKgJ8s.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture1
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildCymbalarm() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/Reypdny.png');
  let texture2 = loader.load('https://i.imgur.com/UHYXfSO.png');
  let texture3 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildCymbalarm2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/iAEsM2q.png');
  let texture2 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildCymballeg() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/Reypdny.png');
  let texture2 = loader.load('https://i.imgur.com/UHYXfSO.png');
  let texture3 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildCymballeg2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/Reypdny.png');
  let texture2 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }));
  return new THREE.Mesh(geometry, materialArray);
}
//////////////////////
function buildSmalldrum(){
	let box = new THREE.Group();
  var geometry = new THREE.CylinderBufferGeometry(10, 10, 13.1, 32 );
  var material = new THREE.MeshLambertMaterial( {color: 'white'} );
  let cylinder1 = new THREE.Mesh( geometry, material );
  cylinder1.position.set(0,-1,-2.8*k);
  var geometry = new THREE.CylinderBufferGeometry(10.1, 10.1, 13, 32 );
  var material = new THREE.MeshLambertMaterial( {color: 'blue'} );
  let cylinder2 = new THREE.Mesh( geometry, material );
  cylinder2.position.set(0,-1,-2.8*k);
  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/DvME6OT.jpg');
	var geometry = new THREE.TorusBufferGeometry( 10.1, 0.5, 32, 100 );
	var material = new THREE.MeshLambertMaterial( { map: texture } );
	let cylinder3 = new THREE.Mesh( geometry, material );
  cylinder3.rotation.x=Math.PI/2;
  cylinder3.position.set(0,6,-2.8*k);
	let cylinder4 = new THREE.Mesh( geometry, material );
  cylinder4.rotation.x=Math.PI/2;
  cylinder4.position.set(0,-8,-2.8*k);
	var geometry = new THREE.BoxBufferGeometry( 14, 1, 1 );
	var material = new THREE.MeshLambertMaterial( {map: texture } );
  let BoxBuffer1= new THREE.Mesh( geometry, material );
  BoxBuffer1.rotation.z=Math.PI/2;
  BoxBuffer1.position.set(10,-1,-2.8*k);
  let BoxBuffer2= new THREE.Mesh( geometry, material );
  BoxBuffer2.rotation.z=Math.PI/2;
  BoxBuffer2.position.set(7.5,-1,-4.1*k);
  let BoxBuffer3= new THREE.Mesh( geometry, material );
  BoxBuffer3.rotation.z=Math.PI/2;
  BoxBuffer3.position.set(0,-1,-4.8*k);
  let BoxBuffer4= new THREE.Mesh( geometry, material );
  BoxBuffer4.rotation.z=Math.PI/2;
  BoxBuffer4.position.set(-7.5,-1,-4.1*k);
  let BoxBuffer5= new THREE.Mesh( geometry, material );
  BoxBuffer5.rotation.z=Math.PI/2;
  BoxBuffer5.position.set(-10,-1,-2.8*k);
  let BoxBuffer6= new THREE.Mesh( geometry, material );
  BoxBuffer6.rotation.z=Math.PI/2;
  BoxBuffer6.position.set(-7.5,-1,-1.5*k);
  let BoxBuffer7= new THREE.Mesh( geometry, material );
  BoxBuffer7.rotation.z=Math.PI/2;
  BoxBuffer7.position.set(0,-1,-0.8*k);
  let BoxBuffer8= new THREE.Mesh( geometry, material );
  BoxBuffer8.rotation.z=Math.PI/2;
  BoxBuffer8.position.set(7.5,-1,-1.5*k);
  var material = new THREE.MeshLambertMaterial( { color: 'white',side:THREE.DoubleSide } );
  let line1 = new THREE.Mesh (new THREE.BoxGeometry(25, 1,1), material); 
  line1.position.set(-1.6*k,12,-1.2*k);
  line1.rotation.set(0,-Math.PI/2.6,Math.PI/4);
  let line2 = new THREE.Mesh (new THREE.BoxGeometry(25, 1, 1), material); 
  line2.position.set(1.6*k,12,-1.2*k);
  line2.rotation.set(0,Math.PI/2.6,-Math.PI/4);
  var material = new THREE.MeshLambertMaterial( { color: 'white',side:THREE.DoubleSide } );
  let line3 = new THREE.Mesh (new THREE.BoxGeometry(14, 1, 1), material); 
  line3.position.set(0,17,1);
  line3.rotation.y=Math.PI;
  box.add(cylinder1,cylinder2,cylinder3,cylinder4,BoxBuffer1,BoxBuffer2,BoxBuffer3,BoxBuffer4,BoxBuffer5,BoxBuffer6,BoxBuffer7,BoxBuffer8,line1,line2,line3);
  return box;
  }
function buildSmalldrumMan(){
  let man = new THREE.Group();
	//GroupA.add(mine);
	let head = makeSmalldrumHead();
	let torso = makeSmalldrumTorso();
  let drum=buildSmalldrum();
	man.add(torso);
	head.position.y = 7.57*k-4.09*k;
	torso.position.y = 4.09*k;
	torso.add(head,drum);

	let leftarm = makeSmalldrumArm();
	leftarm[0].position.set (-1.88*k, 7.57*k-4.09*k, 0);
	leftarm[0].add(leftarm[1]);
	torso.add (leftarm[0]);
	let rightarm = makeSmalldrumArm();
	rightarm[0].position.set (1.88*k, 7.57*k-4.09*k, 0);
	rightarm[0].add(rightarm[1]);
	torso.add(rightarm[0]);


	let leftleg = makeSmalldrumLeg();
	leftleg[0].position.set  (-0.63*k, 4.09*k-4.09*k, 0);
	leftleg[0].add(leftleg[1]);
	torso.add(leftleg[0]);


	let rightleg = makeSmalldrumLeg();
	rightleg[0].position.set (0.63*k, 4.09*k-4.09*k, 0);
	rightleg[0].add(rightleg[1]);
	torso.add(rightleg[0]);

	man.rotation.y=-Math.PI/2;	
	man.position.y=0.01;
	leftarm[0].rotation.z = -Math.PI/2;
	rightarm[0].rotation.z = -Math.PI/2;
	leftleg[0].rotation.z = -Math.PI/2;
	rightleg[0].rotation.z = -Math.PI/2;
	
  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/XQP0bm3.png');
  let alpha = loader.load('https://i.imgur.com/XeDC2uO.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  var shadow = new THREE.Mesh(new THREE.PlaneGeometry(80,80), texMat);
  shadow.rotation.x=Math.PI/2;
  shadow.position.z=6.5;
  shadow.position.y=-9;
  man.add(shadow);
  
	leftarm[0].rotation.order = 'ZYX';
	rightarm[0].rotation.order = 'ZYX';
	leftleg[0].rotation.order = 'ZYX';
	rightleg[0].rotation.order = 'ZYX';
  man.rotation.order = 'ZYX';
  return [man,head,torso,leftarm[0],leftarm[1],rightarm[0],rightarm[1],leftleg[0],leftleg[1],rightleg[0],rightleg[1],leftarm[2],rightarm[2],drum,shadow];
}
function makeSmalldrumArm() {
	var group = new THREE.Group();
 	var group2 = new THREE.Group();
  var stick = new THREE.Group();
  var geometry = new THREE.CylinderBufferGeometry(1, 0.5, 10, 32 );
  var material = new THREE.MeshLambertMaterial( {color: 0xcc7818} );
  let box= new THREE.Mesh( geometry, material );
  var geometry = new THREE.DodecahedronBufferGeometry(1,5 );
  var material = new THREE.MeshLambertMaterial( {color: 0xcc7818} );
  let ball= new THREE.Mesh( geometry, material );
  let body3=buildSmalldrumarm();
  body3.rotation.z=Math.PI/2;
  body3.position.x = 1.92*k;
  let body6=buildSmalldrumarm2();
  body6.rotation.z=Math.PI/2;
  body6.position.x = 1.92*k;
  box.position.set(2*k,0,-5);
  box.rotation.x=Math.PI/2;
  ball.position.set(2*k,0,-10);
  stick.add(ball,box);
  group2.add(stick,body6);
  group.add (group2,body3);
  group2.position.x =2*k;

	return [group,group2,stick];
}
function makeSmalldrumLeg() {
	var group = new THREE.Group();
  var group2 = new THREE.Group();
  let body7=buildSmalldrumleg();
  body7.rotation.z=Math.PI/2;
  body7.position.x = 2.046*k;
  let body8=buildSmalldrumleg2();
  body8.rotation.z=Math.PI/2;
  body8.position.x = 2.046*k;
  group2.add(body8);
	group.add (group2,body7);
  group2.position.x =2.045*k;

	return [group,group2];
}
function makeSmalldrumHead() {
	var headGroup = new THREE.Group();
  let headBody2=buildSmalldrumface();
  headBody2.rotation.y=Math.PI;
	headGroup.add (headBody2);

	return headGroup;
}
function makeSmalldrumTorso () {
	var group = new THREE.Group();
  let Torsobody2=buildSmalldrumTorso();
  Torsobody2.rotation.y=Math.PI;
	group.add (Torsobody2);

return group;

}
function buildSmalldrumface() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, -2.53*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/IYkzEoo.png');
  let texture1 = loader.load('https://i.imgur.com/UyF6RiR.png');
  let texture2 = loader.load('https://i.imgur.com/3vfswFa.png');
  let texture3 = loader.load('https://i.imgur.com/UQYNSe6.png');
  let texture4 = loader.load('https://i.imgur.com/TLdR62i.png');
  let texture5 = loader.load('https://i.imgur.com/E57CwUJ.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture1
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }),
    new THREE.MeshPhongMaterial({
      map: texture4
    }),
    new THREE.MeshPhongMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildSmalldrumTorso() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/9dP72Qr.png');
  let texture1 = loader.load('https://i.imgur.com/aOHqblB.png');
  let texture2 = loader.load('https://i.imgur.com/8khnPtP.png');
  let texture3 = loader.load('https://i.imgur.com/aOHqblB.png');
  let texture4 = loader.load('https://i.imgur.com/zhr9X0w.png');
  let texture5 = loader.load('https://i.imgur.com/2wd7fMD.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture1
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }),
    new THREE.MeshPhongMaterial({
      map: texture4
    }),
    new THREE.MeshPhongMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildSmalldrumarm() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/aANTmBw.png');
  let texture2 = loader.load('https://i.imgur.com/APu9VDq.png');
  let texture3 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildSmalldrumarm2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/eA5BB9i.png');
  let texture2 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildSmalldrumleg() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/CZughnT.png');
  let texture2 = loader.load('https://i.imgur.com/UmnQd9g.png');
  let texture3 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildSmalldrumleg2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/DuEEa4x.png');
  let texture2 = loader.load('https://i.imgur.com/zDr6SGt.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshBasicMaterial({
      map: texture
    }), 
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }),
    new THREE.MeshPhongMaterial({
      map: texture2
    }));
  return new THREE.Mesh(geometry, materialArray);
}
//////////////////////////////
function buildpiano(){
	let piano = new THREE.Group();
  var loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/DF8wSLs.jpg');
  let texture5 = loader.load('https://i.imgur.com/6LDllKV.jpg');
	var geometry = new THREE.BoxBufferGeometry( 45,45, 5 );
	var material = new THREE.MeshPhongMaterial({map: texture5});
	let table = new THREE.Mesh( geometry, material );
	table.rotation.x=Math.PI/2;
  table.position.set(0,10,10);
	var geometry = new THREE.BoxBufferGeometry( 5,5, 30 );
	var material = new THREE.MeshPhongMaterial({map: texture});
	let tableleg = new THREE.Mesh( geometry, material );
	tableleg.rotation.x=Math.PI/2;
  tableleg.position.set(-18,-5,28);
  let tableleg2 = new THREE.Mesh( geometry, material );
	tableleg2.rotation.x=Math.PI/2;
  tableleg2.position.set(18,-5,28);
  let tableleg3 = new THREE.Mesh( geometry, material );
	tableleg3.rotation.x=Math.PI/2;
  tableleg3.position.set(-18,-5,-8);
 	let tableleg4 = new THREE.Mesh( geometry, material );
	tableleg4.rotation.x=Math.PI/2;
  tableleg4.position.set(18,-5,-8);
  loader.crossOrigin = '';
  let texture3 = loader.load('https://i.imgur.com/GsnzBly.jpg');
  var geometry = new THREE.BoxBufferGeometry( 39,4, 2.5 );
	var material = new THREE.MeshPhongMaterial({map: texture3});
  let table2= new THREE.Group();
	table2 = new THREE.Mesh( geometry, material );
  table2.rotation.y=Math.PI/12;
  table2.position.set(0,14.2,15);
  var geometry = new THREE.CylinderBufferGeometry( 39, 39, 4, 3,1,false,0,0.3 );
	var material = new THREE.MeshPhongMaterial( {map: texture3,side:THREE.DoubleSide} );
	let table3 = new THREE.Mesh( geometry, material );
	table3.position.set(-19,14.21,20);
  table3.rotation.y=Math.PI/2;
  var geometry = new THREE.BoxBufferGeometry( 40,4, 11.5 );
	var material = new THREE.MeshPhongMaterial({map: texture3});
	let table4 = new THREE.Mesh( geometry, material );
  table4.position.set(0,14.2,24.5);
  loader.crossOrigin = '';
  let texture4 = loader.load('https://i.imgur.com/6LDllKV.jpg');
  var geometry = new THREE.BoxBufferGeometry( 40.1,4, 11.9 );
	var material = new THREE.MeshPhongMaterial({map: texture4});
	let table5 = new THREE.Mesh( geometry, material );
 	table5.position.set(0,14.5,25);

  
  loader.crossOrigin = '';
  let Pianokey = new THREE.Group();
  let Pianokey2 = new THREE.Group();
  let Pianokey3 = new THREE.Group();
  let Pianokey4 = new THREE.Group();
  let Pianokey5 = new THREE.Group();
  let Pianokey6 = new THREE.Group();
  let Pianokey7 = new THREE.Group();
  let Pianokey8 = new THREE.Group();
  let Pianokey9 = new THREE.Group();
  let Pianokey10 = new THREE.Group();
  let Pianokey11 = new THREE.Group();
  var geometry = new THREE.BoxBufferGeometry( 3,22, 1 );
	var material = new THREE.MeshPhongMaterial({map: texture3});
	let Pianokeys = new THREE.Mesh( geometry, material );
  Pianokeys.rotation.x=Math.PI/2;
  Pianokeys.position.set(0,0,-9.8);
  var geometry = new THREE.BoxBufferGeometry( 3,21, 1 );
 	let Pianokeys2 = new THREE.Mesh( geometry, material );
	Pianokeys2.rotation.x=Math.PI/2;
  Pianokeys2.position.set(0,0,-9.4);
  var geometry = new THREE.BoxBufferGeometry( 3,20, 1 );
  let Pianokeys3 = new THREE.Mesh( geometry, material );
	Pianokeys3.rotation.x=Math.PI/2;
  Pianokeys3.position.set(0,0,-9);
  var geometry = new THREE.BoxBufferGeometry( 3,19, 1 );
 	let Pianokeys4 = new THREE.Mesh( geometry, material );
	Pianokeys4.rotation.x=Math.PI/2;
  Pianokeys4.position.set(0,0,-8.6);
  var geometry = new THREE.BoxBufferGeometry( 3,18, 1 );
 	let Pianokeys5 = new THREE.Mesh( geometry, material );
	Pianokeys5.rotation.x=Math.PI/2;
  Pianokeys5.position.set(0,0,-8.2); 
  var geometry = new THREE.BoxBufferGeometry( 3,17, 1 );
  let Pianokeys6 = new THREE.Mesh( geometry, material );
	Pianokeys6.rotation.x=Math.PI/2;
  Pianokeys6.position.set(0,0,-7.8);
  var geometry = new THREE.BoxBufferGeometry( 3,16, 1 );
  let Pianokeys7 = new THREE.Mesh( geometry, material );
	Pianokeys7.rotation.x=Math.PI/2;
  Pianokeys7.position.set(0,0,-7.4);
  var geometry = new THREE.BoxBufferGeometry( 3,15, 1 );
 	let Pianokeys8 = new THREE.Mesh( geometry, material );
	Pianokeys8.rotation.x=Math.PI/2;
  Pianokeys8.position.set(0,0,-7);
  var geometry = new THREE.BoxBufferGeometry( 3,14, 1 );
  let Pianokeys9 = new THREE.Mesh( geometry, material );
	Pianokeys9.rotation.x=Math.PI/2;
  Pianokeys9.position.set(0,0,-6.6);
  var geometry = new THREE.BoxBufferGeometry( 3,13, 1 );
  let Pianokeys10 = new THREE.Mesh( geometry, material );
	Pianokeys10.rotation.x=Math.PI/2;
  Pianokeys10.position.set(0,0,-6.2);
  var geometry = new THREE.BoxBufferGeometry( 3,12, 1 );
	var material = new THREE.MeshPhongMaterial({map: texture3});
  let Pianokeys11 = new THREE.Mesh( geometry, material );
	Pianokeys11.rotation.x=Math.PI/2;
  Pianokeys11.position.set(0,0,-5.8);
  Pianokey.add(Pianokeys);
  Pianokey.position.set(-17.5,0.8,0);
  Pianokey.rotation.y=-Math.PI/12;
	Pianokey2.add(Pianokeys2);
  Pianokey2.position.set(-14,0.8,0);
  Pianokey2.rotation.y=-Math.PI/12;
  Pianokey3.add(Pianokeys3);
  Pianokey3.position.set(-10.5,0.8,0);
  Pianokey3.rotation.y=-Math.PI/12;
  Pianokey4.add(Pianokeys4);
  Pianokey4.position.set(-7,0.8,0);
  Pianokey4.rotation.y=-Math.PI/12;
  Pianokey5.add(Pianokeys5);
  Pianokey5.position.set(-3.5,0.8,0);
  Pianokey5.rotation.y=-Math.PI/12;
  Pianokey6.add(Pianokeys6);
  Pianokey6.position.set(0,0.5,0);
  Pianokey6.rotation.y=-Math.PI/12;
  Pianokey7.add(Pianokeys7);
  Pianokey7.position.set(3.5,0.5,0);
  Pianokey7.rotation.y=-Math.PI/12;
  Pianokey8.add(Pianokeys8);
  Pianokey8.position.set(7,0.8,0);
  Pianokey8.rotation.y=-Math.PI/12;
  Pianokey9.add(Pianokeys9);
  Pianokey9.position.set(10.5,0.8,0);
  Pianokey9.rotation.y=-Math.PI/12;
  Pianokey10.add(Pianokeys10);
  Pianokey10.position.set(14,0.8,0);
  Pianokey10.rotation.y=-Math.PI/12;
  Pianokey11.add(Pianokeys11);
  Pianokey11.position.set(17.5,0.8,0);
  Pianokey11.rotation.y=-Math.PI/12;
  table2.add(Pianokey,Pianokey2,Pianokey3,Pianokey4,Pianokey5,Pianokey6,Pianokey7,Pianokey8,Pianokey9,Pianokey10,Pianokey11);
  var geometry = new THREE.CircleBufferGeometry( 6, 32,3.14,3.14 );
	var material = new THREE.MeshPhongMaterial( {map: texture5,side:THREE.DoubleSide } );
	let circle = new THREE.Mesh( geometry, material );
  circle.rotation.set(Math.PI,Math.PI/2,0);
	circle.position.set(20.1,12,-4);
	let circle2 = new THREE.Mesh( geometry, material );
  circle2.rotation.set(Math.PI,Math.PI/2,0);
	circle2.position.set(-20.1,12,-4);
  let texture2 = loader.load('https://i.imgur.com/DF8wSLs.jpg');
  var geometry = new THREE.CylinderGeometry( 3, 3, 40, 32 );
	var material = new THREE.MeshPhongMaterial( {map: texture2 } );
  let Pianocylinder= new THREE.Group();
	Pianocylinder = new THREE.Mesh( geometry, material );
  Pianocylinder.position.set(0,15,-4);
  Pianocylinder.rotation.z=Math.PI/2;

  var geometry = new THREE.CylinderGeometry( 2, 2, 1, 32 );
	var material = new THREE.MeshPhongMaterial( {map: texture2 } );
	let Pianocylinder2 = new THREE.Mesh( geometry, material );
  Pianocylinder2.position.set(20,15,-4);
  Pianocylinder2.rotation.z=Math.PI/2;
  var geometry = new THREE.CylinderGeometry( 2, 2, 1, 32 );
	var material = new THREE.MeshPhongMaterial( {map: texture2 } );
	let Pianocylinder3 = new THREE.Mesh( geometry, material );
  Pianocylinder3.position.set(-20,15,-4);
  Pianocylinder3.rotation.z=Math.PI/2;
  loader.crossOrigin = '';
  texture4 = loader.load('https://i.imgur.com/0mWoA40.jpg');
  var geometry = new THREE.BoxBufferGeometry( 4,2, 2 );
	var material = new THREE.MeshPhongMaterial({map: texture4});
  let Pianohead2= new THREE.Group();
	Pianohead2 = new THREE.Mesh( geometry, material );
  Pianohead2.position.set(-21,15,-4);
  var geometry = new THREE.BoxBufferGeometry( 6,2, 2 );
	var material = new THREE.MeshPhongMaterial({map: texture4});
	let Pianohead3 = new THREE.Mesh( geometry, material );
  Pianohead3.rotation.y=Math.PI/2;
  Pianohead3.position.set(-2.5,0,2);
  var geometry = new THREE.BoxBufferGeometry( 4,2, 2 );
	var material = new THREE.MeshPhongMaterial({map: texture4});
	let Pianohead4 = new THREE.Mesh( geometry, material );
  Pianohead4.position.set(-5.5,0,4);
  Pianohead2.add(Pianohead3,Pianohead4);
  var geometry = new THREE.SphereGeometry( 0.25, 32, 32 );
	var material = new THREE.MeshPhongMaterial( {color: texture2} );
	let sphere = new THREE.Mesh( geometry, material );
  sphere.position.set(0,6.8,3);
	let sphere2 = new THREE.Mesh( geometry, material );
  sphere2.position.set(-0.3,17,2.95);
 	let sphere3 = new THREE.Mesh( geometry, material );
  sphere3.position.set(-0.6,6.8,2.87);
  let sphere4 = new THREE.Mesh( geometry, material );
  sphere4.position.set(-0.9,0,2.78);
	let sphere5 = new THREE.Mesh( geometry, material );
  sphere5.position.set(-1.2,6.8,2.7);
 	let sphere6 = new THREE.Mesh( geometry, material );
  sphere6.position.set(-1.5,0,2.6);
  let sphere7 = new THREE.Mesh( geometry, material );
  sphere7.position.set(-1.8,-6.8,2.45);
 	let sphere8 = new THREE.Mesh( geometry, material );
  sphere8.position.set(-2,6.8,2.3);
  
  let sphere9 = new THREE.Mesh( geometry, material );
  sphere9.position.set(-2.1,-17,2.1);
  let sphere10 = new THREE.Mesh( geometry, material );
  sphere10.position.set(-2.3,-13.6,1.8);
  let sphere11 = new THREE.Mesh( geometry, material );
  sphere11.position.set(-2.45,-10.2,1.5);
	let sphere12 = new THREE.Mesh( geometry, material );
  sphere12.position.set(-2.6,-6.8,1.2);
 	let sphere13 = new THREE.Mesh( geometry, material );
  sphere13.position.set(-2.95,-6.8,0.3);
  
  let sphere14 = new THREE.Mesh( geometry, material );
  sphere14.position.set(-3,-6.8,0);
  let sphere15 = new THREE.Mesh( geometry, material );
  sphere15.position.set(-2.95,-3.4,-0.3);
  let sphere16 = new THREE.Mesh( geometry, material );
  sphere16.position.set(-2.87,3.4,-0.6);
  let sphere17 = new THREE.Mesh( geometry, material );
  sphere17.position.set(-2.78,10.2,-0.9);
  let sphere18 = new THREE.Mesh( geometry, material );
  sphere18.position.set(-2.7,17,-1.2);
  let sphere19 = new THREE.Mesh( geometry, material );
  sphere19.position.set(-2.6,10.2,-1.5);
  let sphere20 = new THREE.Mesh( geometry, material );
  sphere20.position.set(-2.45,3.4,-1.8);
  let sphere21 = new THREE.Mesh( geometry, material );
  sphere21.position.set(-2.3,-3.4,-2);
  
  let sphere22 = new THREE.Mesh( geometry, material );
  sphere22.position.set(-2.1,0,-2.1);
  let sphere23 = new THREE.Mesh( geometry, material );
  sphere23.position.set(-2,6.8,-2.3);
  let sphere24 = new THREE.Mesh( geometry, material );
  sphere24.position.set(-1.8,-10.2,-2.45);
  let sphere25 = new THREE.Mesh( geometry, material );
  sphere25.position.set(-1.5,-6.8,-2.6);
  let sphere26 = new THREE.Mesh( geometry, material );
  sphere26.position.set(0.3,6.8,-2.95);
  
  let sphere27 = new THREE.Mesh( geometry, material );
  sphere27.position.set(0,6.8,-3);
  let sphere28 = new THREE.Mesh( geometry, material );
  sphere28.position.set(0.3,17,-2.95);
  let sphere29 = new THREE.Mesh( geometry, material );
  sphere29.position.set(0.6,6.8,-2.87);
  let sphere30 = new THREE.Mesh( geometry, material );
  sphere30.position.set(0.9,0,-2.78);
  let sphere31 = new THREE.Mesh( geometry, material );
  sphere31.position.set(1.2,6.8,-2.7);
  let sphere32 = new THREE.Mesh( geometry, material );
  sphere32.position.set(1.5,0,-2.6);
  let sphere33 = new THREE.Mesh( geometry, material );
  sphere33.position.set(1.8,-6.8,-2.45); 
  let sphere34 = new THREE.Mesh( geometry, material );
  sphere34.position.set(2,6.8,-2.3);
  
  let sphere35 = new THREE.Mesh( geometry, material );
  sphere35.position.set(2.1,-17,-2.1);
  let sphere36 = new THREE.Mesh( geometry, material );
  sphere36.position.set(2.3,-13.6,-1.8);
  let sphere37 = new THREE.Mesh( geometry, material );
  sphere37.position.set(2.45,-10.2,-1.5);
	let sphere38 = new THREE.Mesh( geometry, material );
  sphere38.position.set(2.6,-6.8,-1.2);
 	let sphere39 = new THREE.Mesh( geometry, material );
  sphere39.position.set(2.95,6.8,-0.3);
  
  let sphere40 = new THREE.Mesh( geometry, material );
  sphere40.position.set(3,-6.8,0);
  let sphere41 = new THREE.Mesh( geometry, material );
  sphere41.position.set(2.95,-3.4,0.3);
  let sphere42 = new THREE.Mesh( geometry, material );
  sphere42.position.set(2.87,3.4,0.6);
  let sphere43 = new THREE.Mesh( geometry, material );
  sphere43.position.set(2.78,10.2,0.9);
  let sphere44 = new THREE.Mesh( geometry, material );
  sphere44.position.set(2.7,17,1.2);
  let sphere45 = new THREE.Mesh( geometry, material );
  sphere45.position.set(2.6,10.2,1.5);
  let sphere46 = new THREE.Mesh( geometry, material );
  sphere46.position.set(2.45,3.4,1.8);
  let sphere47 = new THREE.Mesh( geometry, material );
  sphere47.position.set(2.3,10.2,2);
  
  let sphere48 = new THREE.Mesh( geometry, material );
  sphere48.position.set(2.1,6.8,2.1);
  let sphere49 = new THREE.Mesh( geometry, material );
  sphere49.position.set(2,17,2.3);
  let sphere50 = new THREE.Mesh( geometry, material );
  sphere50.position.set(1.8,0,2.45);
  let sphere51 = new THREE.Mesh( geometry, material );
  sphere51.position.set(1.5,6.8,2.6);
  let sphere52 = new THREE.Mesh( geometry, material );
  sphere52.position.set(-0.3,6.8,2.95);
  
	Pianocylinder.add(sphere,sphere2,sphere3,sphere4,sphere5,sphere6,sphere7,sphere8,sphere9,sphere10,sphere11,sphere12,sphere13,sphere14,sphere15,sphere16,sphere17,sphere18,sphere19,sphere20,sphere21,sphere22,sphere23,sphere24,sphere25,sphere26,sphere27,sphere28,sphere29,sphere30,sphere31,sphere32,sphere33,sphere34,sphere35,sphere36,sphere37,sphere38,sphere39,sphere40,sphere41,sphere42,sphere43,sphere44,sphere45,sphere46,sphere47,sphere48,sphere49,sphere50,sphere51,sphere52);
  piano.add(table,tableleg,tableleg2,tableleg3,tableleg4,table2,table3,table4,table5,circle,circle2,Pianocylinder,Pianocylinder2,Pianocylinder3,Pianohead2);
    return [piano,Pianocylinder,Pianohead2,Pianokey,Pianokey3,Pianokey4,Pianokey5,Pianokey6,Pianokey7,Pianokey8,Pianokey9,Pianokey10,Pianokey11];
  }
function buildpianoMan(){
  let man = new THREE.Group();
	//GroupA.add(mine);
	let head = makepianoHead();
	let torso = makepianoTorso();
	man.add(torso);
	head.position.y = 7.57*k-4.09*k;
	torso.position.y = 4.09*k;
	torso.add(head);

	let leftarm = makepianoArm();
	leftarm[0].position.set (-1.88*k, 7.57*k-4.09*k, 0);
	leftarm[0].add(leftarm[1]);
	torso.add (leftarm[0]);
	let rightarm = makepianoArm();
	rightarm[0].position.set (1.88*k, 7.57*k-4.09*k, 0);
	rightarm[0].add(rightarm[1]);
	torso.add(rightarm[0]);


	let leftleg = makepianoLeg();
	leftleg[0].position.set  (-0.63*k, 4.09*k-4.09*k, 0);
	leftleg[0].add(leftleg[1]);
	torso.add(leftleg[0]);


	let rightleg = makepianoLeg();
	rightleg[0].position.set (0.63*k, 4.09*k-4.09*k, 0);
	rightleg[0].add(rightleg[1]);
	torso.add(rightleg[0]);

	man.rotation.y=-Math.PI/2;	
	man.position.y=0.01;
	leftarm[0].rotation.z = -Math.PI/2;
	rightarm[0].rotation.z = -Math.PI/2;
	leftleg[0].rotation.z = -Math.PI/2;
	rightleg[0].rotation.z = -Math.PI/2;
	
  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/XQP0bm3.png');
  let alpha = loader.load('https://i.imgur.com/XeDC2uO.png');

  var texMat = new THREE.MeshPhongMaterial({
    map: texture,
    alphaMap: alpha,
    transparent: true,
    side: THREE.DoubleSide
  });
  var shadow = new THREE.Mesh(new THREE.PlaneGeometry(80,80), texMat);
  shadow.rotation.x=Math.PI/2;
  shadow.position.z=6.5;
  shadow.position.y=-9;
  man.add(shadow);
  
	leftarm[0].rotation.order = 'ZYX';
	rightarm[0].rotation.order = 'ZYX';
	leftleg[0].rotation.order = 'ZYX';
	rightleg[0].rotation.order = 'ZYX';
  man.rotation.order = 'ZYX';
  return [man,head,torso,leftarm[0],leftarm[1],rightarm[0],rightarm[1],leftleg[0],leftleg[1],rightleg[0],rightleg[1],shadow];
}
function makepianoArm() {
	var group = new THREE.Group();
 	var group2 = new THREE.Group();
  let body3=buildpianoarm();
  body3.rotation.z=Math.PI/2;
  body3.position.x = 1.92*k;
  let body6=buildpianoarm2();
  body6.rotation.z=Math.PI/2;
  body6.position.x = 1.92*k;
  group2.add(body6);
  group.add (group2,body3);
  group2.position.x =2*k;
  
	return [group,group2];
}
function makepianoLeg() {
	var group = new THREE.Group();
  var group2 = new THREE.Group();
  let body7=buildpianoleg();
  body7.rotation.z=Math.PI/2;
  body7.position.x = 2.046*k;
  let body8=buildpianoleg2();
  body8.rotation.z=Math.PI/2;
  body8.position.x = 2.046*k;
  group2.add(body8);
	group.add (group2,body7);
  group2.position.x =2.045*k;

	return [group,group2];
}
function makepianoHead() {
	var headGroup = new THREE.Group();
  let headBody2=buildpianoface();
  headBody2.rotation.y=Math.PI;
	headGroup.add (headBody2);
	return headGroup;
}
function makepianoTorso () {
	var group = new THREE.Group();
  let Torsobody2=buildpianoTorso();
  Torsobody2.rotation.y=Math.PI;
	group.add (Torsobody2);

return group;

}
function buildpianoface() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, 2.53*k/2),
    new THREE.Vector3(2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(2.53*k/2, 2.53*k, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -2.53*k/2),
    new THREE.Vector3(-2.53*k/2, 2.53*k, -2.53*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/uVxiQjz.png');
  let texture1 = loader.load('https://i.imgur.com/kRM08kR.png');
  let texture2 = loader.load('https://i.imgur.com/YcnUc4I.png');
  let texture3 = loader.load('https://i.imgur.com/M6gmbIE.png');
  let texture4 = loader.load('https://i.imgur.com/MaKqwSw.png');
  let texture5 = loader.load('https://i.imgur.com/rCD0El1.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture1
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildpianoTorso() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, 1.27*k/2),
    new THREE.Vector3(2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(2.53*k/2, 3.48*k, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-2.53*k/2, 3.48*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();

  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/K7NDCx9.png');
  let texture1 = loader.load('https://i.imgur.com/Kx36owY.png');
  let texture2 = loader.load('https://i.imgur.com/E4Hlz6e.png');
  let texture3 = loader.load('https://i.imgur.com/Ypg7QB0.png');
  let texture4 = loader.load('https://i.imgur.com/Fm3AKao.png');
  let texture5 = loader.load('https://i.imgur.com/RlVGtn5.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture1
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture5
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildpianoarm() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/wWHpWBu.png');
  let texture2 = loader.load('https://i.imgur.com/MjjHF4J.png');
  let texture3 = loader.load('https://i.imgur.com/KOPTK66.png');
  let texture4 = loader.load('https://i.imgur.com/6YyhA58.png');
  let texture5 = loader.load('https://i.imgur.com/ZDZSwkU.png');
  let texture6 = loader.load('https://i.imgur.com/pInkXB9.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture5
    }),
    new THREE.MeshBasicMaterial({
      map: texture6
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildpianoarm2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, 1.25*k/2),
    new THREE.Vector3(1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(1.25*k/2, 1.93*k, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 0, -1.25*k/2),
    new THREE.Vector3(-1.25*k/2, 1.93*k, -1.25*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/PY46M0k.png');
  let texture2 = loader.load('https://i.imgur.com/Soq6hr9.png');
  let texture3 = loader.load('https://i.imgur.com/GRK8FVc.png');
  let texture4 = loader.load('https://i.imgur.com/pInkXB9.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildpianoleg() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/FgHtTy3.png');
  let texture2 = loader.load('https://i.imgur.com/mRYW7v6.png');
  let texture3 = loader.load('https://i.imgur.com/pInkXB9.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture
    }), 
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }));
  return new THREE.Mesh(geometry, materialArray);
}
function buildpianoleg2() {
  let geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, 1.27*k/2),
    new THREE.Vector3(1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(1.27*k/2, 2.046*k, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 0, -1.27*k/2),
    new THREE.Vector3(-1.27*k/2, 2.046*k, -1.27*k/2),
  );


  let face;
  face = new THREE.Face3(0, 1, 2);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(2, 3, 0);
  face.materialIndex = 0;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 4, 5);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 2, 1);
  face.materialIndex = 1;
  geometry.faces.push(face);
  face = new THREE.Face3(4, 6, 7);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(7, 5, 4);
  face.materialIndex = 2;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 0, 3);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 7, 6);
  face.materialIndex = 3;
  geometry.faces.push(face);
  face = new THREE.Face3(3, 2, 5);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(5, 7, 3);
  face.materialIndex = 4;
  geometry.faces.push(face);
  face = new THREE.Face3(6, 4, 1);
  face.materialIndex = 5;
  geometry.faces.push(face);
  face = new THREE.Face3(1, 0, 6);
  face.materialIndex = 5;
  geometry.faces.push(face);
  
  
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(0, 0), new THREE.Vector2(1, 0), new THREE.Vector2(1, 1)]);
  geometry.faceVertexUvs[0].push([new THREE.Vector2(1, 1), new THREE.Vector2(0, 1), new THREE.Vector2(0, 0)]);
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();


  let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/yarFoC2.png');
  let texture2 = loader.load('https://i.imgur.com/eOce6wK.png');
  let texture3 = loader.load('https://i.imgur.com/pInkXB9.png');
  let texture4 = loader.load('https://i.imgur.com/CvOpHOI.png');
  let materialArray = [];
  materialArray.push(new THREE.MeshLambertMaterial({
      map: texture2
    }), 
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture
    }),
    new THREE.MeshBasicMaterial({
      map: texture2
    }),
    new THREE.MeshBasicMaterial({
      map: texture3
    }),
    new THREE.MeshBasicMaterial({
      map: texture4
    }));
  return new THREE.Mesh(geometry, materialArray);
}
////////////////////////////////
function buildtire() {

		var loader = new THREE.TextureLoader();
    loader.crossOrigin = '';
    var colormap = loader.load ('http://jyunming-chen.github.io/tutsplus/images/tire-side.png');
    var colormap2 = loader.load ('http://jyunming-chen.github.io/tutsplus/images/tire-wheel.jpg');
    
    var tire = new THREE.Object3D();
    var geometry = new THREE.CircleGeometry(10, 30);
    var material = new THREE.MeshBasicMaterial({
        map: colormap,
       // transparent: true,  // for cut-out texture
        alphaTest: 0.5,
        side: THREE.DoubleSide
    });
    let carmesh1 = new THREE.Mesh(geometry, material);
colormap2.wrapS = colormap2.wrapT = THREE.RepeatWrapping; 
	colormap2.repeat.set( 8, 1 );
    let carmesh2 = new THREE.Mesh(new THREE.CylinderGeometry(10, 10, 10, 30, 1, true), // only side
    new THREE.MeshBasicMaterial({
        map: colormap2,
        side: THREE.DoubleSide
    }));
    carmesh2.rotation.x = Math.PI / 2;
    carmesh1.position.set(0, 0, 5);
    let carmesh0 = carmesh1.clone();
    carmesh0.position.set(0, 0, -5);
    carmesh0.rotation.y = Math.PI;
    tire.add (carmesh1);
    tire.add(carmesh0);
    tire.add(carmesh2);
    return tire;
}
function buildcar(){
	var c = new THREE.Group();
	let tire1=buildtire();
  tire1.position.set(0,10,15);
  let tire2=buildtire();
  tire2.position.set(0,10,-15);
  var material = new THREE.MeshBasicMaterial( { color:'black',side:THREE.DoubleSide } );
  let box = new THREE.Mesh (new THREE.BoxGeometry(20, 15, 2), material); 
  box.rotation.set(Math.PI/2,0,Math.PI/2);
  box.position.set(0,10,0);
  c.add(tire1,tire2,box);
  return c;
}
function buildBackground(){
	var back = new THREE.Group();
	let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/TMNe2WF.jpg');
  let floor = new THREE.Mesh(new THREE.PlaneGeometry(L, L),
  new THREE.MeshBasicMaterial({map: texture,side: THREE.DoubleSide}));
  floor.rotation.x = -Math.PI / 2;
  floor.receiveShadow = true;
  back.add(floor);
  let light = new THREE.SpotLight(0x888888, 1.5);
  light.position.set(0, L/2 +10, 100);
  light.angle = Math.PI/3;
  light.penumbra = 1
  back.add(light);
  return back;
}
function buildLogo() {
  var geometry = new THREE.Geometry();
  geometry.vertices.push(
    new THREE.Vector3(-50, -60, 0),
    new THREE.Vector3(50, -60, 0),
    new THREE.Vector3(50, 60, 0),
    new THREE.Vector3(-50, 60, 0)
  );

  var face;
  face = new THREE.Face3(0, 1, 2);
  geometry.faces.push(face);
  face = new THREE.Face3(0, 2, 3);
  geometry.faces.push(face);

  let st0 = new THREE.Vector2(0, 0.5);
  let st1 = new THREE.Vector2(0.25, 0.5);
  let st2 = new THREE.Vector2(0.25, 1);
  let st3 = new THREE.Vector2(0, 1);
  geometry.faceVertexUvs[0].push([st0, st1, st2]);
  geometry.faceVertexUvs[0].push([st0, st2, st3]);

  geometry.computeBoundingSphere();
  geometry.computeFaceNormals();
  geometry.computeVertexNormals();
  return geometry;
}
function buildPointer(){
	let back = new THREE.Group();
	let loader = new THREE.TextureLoader();
  loader.crossOrigin = '';
  let texture = loader.load('https://i.imgur.com/hZJWo8x.png');
  let pointer = new THREE.Mesh(new THREE.PlaneGeometry(30, 25),
  new THREE.MeshPhongMaterial({map: texture,alphaTest: 0.5,side: THREE.DoubleSide}));
  pointer.rotation.x = -Math.PI / 2;
  pointer.receiveShadow = true;
  back.add(pointer);
  return back;
}

function Drumkeyframe(t) {
	T = 475/68.5;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Drumkeys.length; i++) {
    if (Drumkeys[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Drumkeys[ii][0]) / (Drumkeys[ii + 1][0] - Drumkeys[ii][0]);
  intKey1 = [Drumkeys[ii][1].Dtheta1 * (1 - a) + Drumkeys[ii + 1][1].Dtheta1 * a,
       Drumkeys[ii][1].Dtheta2 * (1 - a) + Drumkeys[ii + 1][1].Dtheta2 * a,
       Drumkeys[ii][1].Dtheta3 * (1 - a) + Drumkeys[ii + 1][1].Dtheta3 * a,
       Drumkeys[ii][1].Dtheta4 * (1 - a) + Drumkeys[ii + 1][1].Dtheta4 * a,
       Drumkeys[ii][1].Dtheta5 * (1 - a) + Drumkeys[ii + 1][1].Dtheta5 * a,
       Drumkeys[ii][1].Dtheta6 * (1 - a) + Drumkeys[ii + 1][1].Dtheta6 * a,
       Drumkeys[ii][1].Dtheta7 * (1 - a) + Drumkeys[ii + 1][1].Dtheta7 * a,
       Drumkeys[ii][1].Dtheta8 * (1 - a) + Drumkeys[ii + 1][1].Dtheta8 * a,
       Drumkeys[ii][1].Dtheta9 * (1 - a) + Drumkeys[ii + 1][1].Dtheta9 * a,
       Drumkeys[ii][1].Dtheta10 * (1 - a) + Drumkeys[ii + 1][1].Dtheta10 * a,
       Drumkeys[ii][1].Dtheta11 * (1 - a) + Drumkeys[ii + 1][1].Dtheta11 * a,
       Drumkeys[ii][1].Dtheta12 * (1 - a) + Drumkeys[ii + 1][1].Dtheta12 * a
  ];

}
function Drumkeyframe2(t) {
	T =1200/60;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Drumkeys2.length; i++) {
    if (Drumkeys2[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Drumkeys2[ii][0]) / (Drumkeys2[ii + 1][0] - Drumkeys2[ii][0]);
  intKey = [Drumkeys2[ii][1].Dtheta1 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta1 * a,
            Drumkeys2[ii][1].Dtheta2 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta2 * a,
            Drumkeys2[ii][1].Dtheta3 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta3 * a,
            Drumkeys2[ii][1].Dtheta4 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta4 * a,
            Drumkeys2[ii][1].Dtheta5 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta5 * a,
            Drumkeys2[ii][1].Dtheta6 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta6 * a,
            Drumkeys2[ii][1].Dtheta7 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta7 * a,
            Drumkeys2[ii][1].Dtheta8 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta8 * a,
            Drumkeys2[ii][1].Dtheta9 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta9 * a,
            Drumkeys2[ii][1].Dtheta10 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta10 * a,
            Drumkeys2[ii][1].Dtheta11 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta11 * a,
            Drumkeys2[ii][1].Dtheta12 * (1 - a) + Drumkeys2[ii + 1][1].Dtheta12 * a
  ];

}
function Cymbalkeyframe(t) {
	T = 240/75.5;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Cymbalkeys.length; i++) {
    if (Cymbalkeys[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Cymbalkeys[ii][0]) / (Cymbalkeys[ii + 1][0] - Cymbalkeys[ii][0]);
  intKey2 = [Cymbalkeys[ii][1].Ctheta1 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta1 * a,
       Cymbalkeys[ii][1].Ctheta2 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta2 * a,
       Cymbalkeys[ii][1].Ctheta3 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta3 * a,
       Cymbalkeys[ii][1].Ctheta4 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta4 * a,
       Cymbalkeys[ii][1].Ctheta5 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta5 * a,
       Cymbalkeys[ii][1].Ctheta6 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta6 * a,
       Cymbalkeys[ii][1].Ctheta7 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta7 * a,
       Cymbalkeys[ii][1].Ctheta8 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta8 * a,
       Cymbalkeys[ii][1].Ctheta9 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta9 * a,
       Cymbalkeys[ii][1].Ctheta10 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta10 * a,
       Cymbalkeys[ii][1].Ctheta11 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta11 * a,
       Cymbalkeys[ii][1].Ctheta12 * (1 - a) + Cymbalkeys[ii + 1][1].Ctheta12 * a
  ];

}
function Cymbalkeyframe2(t) {
	T =1200/60;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Cymbalkeys2.length; i++) {
    if (Cymbalkeys2[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Cymbalkeys2[ii][0]) / (Cymbalkeys2[ii + 1][0] - Cymbalkeys2[ii][0]);
  intKey2 = [Cymbalkeys2[ii][1].Ctheta1 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta1 * a,
            Cymbalkeys2[ii][1].Ctheta2 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta2 * a,
            Cymbalkeys2[ii][1].Ctheta3 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta3 * a,
            Cymbalkeys2[ii][1].Ctheta4 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta4 * a,
            Cymbalkeys2[ii][1].Ctheta5 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta5 * a,
            Cymbalkeys2[ii][1].Ctheta6 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta6 * a,
            Cymbalkeys2[ii][1].Ctheta7 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta7 * a,
            Cymbalkeys2[ii][1].Ctheta8 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta8 * a,
            Cymbalkeys2[ii][1].Ctheta9 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta9 * a,
            Cymbalkeys2[ii][1].Ctheta10 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta10 * a,
            Cymbalkeys2[ii][1].Ctheta11 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta11 * a,
            Cymbalkeys2[ii][1].Ctheta12 * (1 - a) + Cymbalkeys2[ii + 1][1].Ctheta12 * a
  ];

}
function Smallkeyframe(t) {
	T = 960/104;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Smallkeys.length; i++) {
    if (Smallkeys[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Smallkeys[ii][0]) / (Smallkeys[ii + 1][0] - Smallkeys[ii][0]);
  intKey3 = [Smallkeys[ii][1].Stheta1 * (1 - a) + Smallkeys[ii + 1][1].Stheta1 * a,
            Smallkeys[ii][1].Stheta2 * (1 - a) + Smallkeys[ii + 1][1].Stheta2 * a,
            Smallkeys[ii][1].Stheta3 * (1 - a) + Smallkeys[ii + 1][1].Stheta3 * a,
            Smallkeys[ii][1].Stheta4 * (1 - a) + Smallkeys[ii + 1][1].Stheta4 * a,
            Smallkeys[ii][1].Stheta5 * (1 - a) + Smallkeys[ii + 1][1].Stheta5 * a,
            Smallkeys[ii][1].Stheta6 * (1 - a) + Smallkeys[ii + 1][1].Stheta6 * a,
            Smallkeys[ii][1].Stheta7 * (1 - a) + Smallkeys[ii + 1][1].Stheta7 * a,
            Smallkeys[ii][1].Stheta8 * (1 - a) + Smallkeys[ii + 1][1].Stheta8 * a,
            Smallkeys[ii][1].Stheta9 * (1 - a) + Smallkeys[ii + 1][1].Stheta9 * a,
            Smallkeys[ii][1].Stheta10 * (1 - a) + Smallkeys[ii + 1][1].Stheta10 * a,
            Smallkeys[ii][1].Stheta11 * (1 - a) + Smallkeys[ii + 1][1].Stheta11 * a,
            Smallkeys[ii][1].Stheta12 * (1 - a) + Smallkeys[ii + 1][1].Stheta12 * a,
            Smallkeys[ii][1].Stheta13 * (1 - a) + Smallkeys[ii + 1][1].Stheta13 * a,
            Smallkeys[ii][1].Stheta14 * (1 - a) + Smallkeys[ii + 1][1].Stheta14 * a
  ];

}
function Smallkeyframe2(t) {
	T =1200/60;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < Smallkeys2.length; i++) {
    if (Smallkeys2[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Smallkeys2[ii][0]) / (Smallkeys2[ii + 1][0] - Smallkeys2[ii][0]);
  intKey3= [Smallkeys2[ii][1].Stheta1 * (1 - a) + Smallkeys2[ii + 1][1].Stheta1 * a,
            Smallkeys2[ii][1].Stheta2 * (1 - a) + Smallkeys2[ii + 1][1].Stheta2 * a,
            Smallkeys2[ii][1].Stheta3 * (1 - a) + Smallkeys2[ii + 1][1].Stheta3 * a,
            Smallkeys2[ii][1].Stheta4 * (1 - a) + Smallkeys2[ii + 1][1].Stheta4 * a,
            Smallkeys2[ii][1].Stheta5 * (1 - a) + Smallkeys2[ii + 1][1].Stheta5 * a,
            Smallkeys2[ii][1].Stheta6 * (1 - a) + Smallkeys2[ii + 1][1].Stheta6 * a,
            Smallkeys2[ii][1].Stheta7 * (1 - a) + Smallkeys2[ii + 1][1].Stheta7 * a,
            Smallkeys2[ii][1].Stheta8 * (1 - a) + Smallkeys2[ii + 1][1].Stheta8 * a,
            Smallkeys2[ii][1].Stheta9 * (1 - a) + Smallkeys2[ii + 1][1].Stheta9 * a,
            Smallkeys2[ii][1].Stheta10 * (1 - a) + Smallkeys2[ii + 1][1].Stheta10 * a,
            Smallkeys2[ii][1].Stheta11 * (1 - a) + Smallkeys2[ii + 1][1].Stheta11 * a,
            Smallkeys2[ii][1].Stheta12 * (1 - a) + Smallkeys2[ii + 1][1].Stheta12 * a,
            Smallkeys2[ii][1].Stheta13 * (1 - a) + Smallkeys2[ii + 1][1].Stheta13 * a,
            Smallkeys2[ii][1].Stheta14 * (1 - a) + Smallkeys2[ii + 1][1].Stheta14 * a
  ];

}
function Pmankeyframe(t) {
	T2 = 600/60;
  var s = ((t - ts) % T2) / T2;

  for (var i = 1; i < Pmankeys.length; i++) {
    if (Pmankeys[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - Pmankeys[ii][0]) / (Pmankeys[ii + 1][0] - Pmankeys[ii][0]);
  intKey4 = [Pmankeys[ii][1].Pmtheta1 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta1 * a,
            Pmankeys[ii][1].Pmtheta2 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta2 * a,
            Pmankeys[ii][1].Pmtheta3 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta3 * a,
            Pmankeys[ii][1].Pmtheta4 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta4 * a,
            Pmankeys[ii][1].Pmtheta5 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta5 * a,
            Pmankeys[ii][1].Pmtheta6 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta6 * a,
            Pmankeys[ii][1].Pmtheta7 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta7 * a,
            Pmankeys[ii][1].Pmtheta8 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta8 * a,
            Pmankeys[ii][1].Pmtheta9 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta9 * a,
            Pmankeys[ii][1].Pmtheta10 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta10 * a,
            Pmankeys[ii][1].Pmtheta11 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta11 * a,
            Pmankeys[ii][1].Pmtheta12 * (1 - a) + Pmankeys[ii + 1][1].Pmtheta12 * a
  ];

}
function keyframe5(t) {
	T =1200/60;
  var s = ((t - ts) % T) / T;

  for (var i = 1; i < keys5.length; i++) {
    if (keys5[i][0] > s) break;
  }
  // take i-1
  var ii = i - 1;
  var a = (s - keys5[ii][0]) / (keys5[ii + 1][0] - keys5[ii][0]);
  intKey5 = [keys5[ii][1].theta1 * (1 - a) + keys5[ii + 1][1].theta1 * a,
            keys5[ii][1].theta2 * (1 - a) + keys5[ii + 1][1].theta2 * a,
            keys5[ii][1].theta3 * (1 - a) + keys5[ii + 1][1].theta3 * a,
            keys5[ii][1].theta4 * (1 - a) + keys5[ii + 1][1].theta4 * a,
            keys5[ii][1].theta5 * (1 - a) + keys5[ii + 1][1].theta5 * a,
            keys5[ii][1].theta6 * (1 - a) + keys5[ii + 1][1].theta6 * a,
            keys5[ii][1].theta7 * (1 - a) + keys5[ii + 1][1].theta7 * a,
            keys5[ii][1].theta8 * (1 - a) + keys5[ii + 1][1].theta8 * a,
            keys5[ii][1].theta9 * (1 - a) + keys5[ii + 1][1].theta9 * a,
            keys5[ii][1].theta10 * (1 - a) + keys5[ii + 1][1].theta10 * a
  ];

}

function searchFace () {
	var maxDot = -1;
  let which;
	var normals = {B: new THREE.Vector3(1,0,0), E: new THREE.Vector3(0,1,0),A: new THREE.Vector3(0,0,1),D: new THREE.Vector3(-1,0,0), F: new THREE.Vector3(0,-1,0), C: new THREE.Vector3(0,0,-1)};
	var centers = {B: new THREE.Vector3(L/2,0,0), E: new THREE.Vector3(0,L/2,0), A: new THREE.Vector3(0,0,L/2),D: new THREE.Vector3(-L/2,0,0), F: new THREE.Vector3(0,-L/2,0), C: new THREE.Vector3(0,0,-L/2)};
  
  let dd,point;
  let visible =[];
  point = camera.position.clone().sub(centers['B']).normalize();
  if(normals['B'].dot(point)>=0)visible.push('B');
  point = camera.position.clone().sub(centers['E']).normalize();
  if(normals['E'].dot(point)>=0)visible.push('E');
  point = camera.position.clone().sub(centers['A']).normalize();
  if(normals['A'].dot(point)>=0)visible.push('A');
  point = camera.position.clone().sub(centers['D']).normalize();
  if(normals['D'].dot(point)>=0)visible.push('D');
  point = camera.position.clone().sub(centers['F']).normalize();
  if(normals['F'].dot(point)>=0)visible.push('F');
  point = camera.position.clone().sub(centers['C']).normalize();
  if(normals['C'].dot(point)>=0)visible.push('C');
	//compute cameraUp
  let cameraUp = camera.localToWorld(new THREE.Vector3(0,1,0)).sub(camera.position);
	for(var i = 0;i < visible.length;i++){
  	dd = normals[visible[i]].dot(cameraUp);
    if(dd> maxDot){
    	maxDot = dd;
      which = visible[i];
    }
  }
  
	return which;
}

function setAllFacesTransparent () {
	if(GroupA.children[0].position.x<L/2&&GroupA.children[0].position.x>-L/2&&GroupA.children[0].position.z<L/2&&GroupA.children[0].position.z>-L/2&&GroupA.children[0].position.y==0){
    faces['B'].visible = false;
    faces['E'].visible = false;
    faces['A'].visible = true;
    faces['C'].visible = false;
    
  }
  if(GroupA.children[0].position.y<0&&GroupA.children[0].position.y>-L&&GroupA.children[0].position.z<L/2&&GroupA.children[0].position.z>-L/2&&GroupA.children[0].position.x==L/2){
    faces['B'].visible = true;
    faces['E'].visible = false;
    faces['A'].visible = false;
    faces['C'].visible = false;
  }
  if(GroupA.children[0].position.x<L/2&&GroupA.children[0].position.x>-L/2&&GroupA.children[0].position.z<L/2&&GroupA.children[0].position.z>-L/2&&GroupA.children[0].position.y==-L){
    faces['B'].visible = false;
    faces['E'].visible = false;
    faces['A'].visible = false;
    faces['C'].visible = true;
  }

  if(GroupA.children[0].position.y<0&&GroupA.children[0].position.y>-L&&GroupA.children[0].position.x<L/2&&GroupA.children[0].position.x>-L/2&&GroupA.children[0].position.z==-L/2){
    faces['B'].visible = false;
    faces['E'].visible = true;
    faces['A'].visible = false;
    faces['C'].visible = false;
  }
  
}
function textureAnimate() {
  if (GroupD.children[2]) {
    var texture = GroupD.children[2].material.map;
    texture.offset.x += 0.25;
    if (texture.offset.x === Math.floor(texture.offset.x))
      texture.offset.y += 0.5;
  }
}
function animate() {
  controls.update();
	count++;
  if (count % 50 === 0) {  // a crude way to set animation frequency
    textureAnimate();
  }
  setAllFacesTransparent();
	
	let which = searchFace();
  var timeFromStart = clock.getElapsedTime();
	var eT = (timeFromStart - lastChangeTime ).toFixed(0);
  /*var output = `${keyNow}: ${eT} `;
  $('#output').text (output);*/
	GroupA.children[1].visible = false;
  GroupB.children[1].visible = false;
  GroupC.children[1].visible = false;
  GroupD.children[0].visible = false;
  GroupE.children[1].visible = false;
  GroupF.children[0].visible = false;
  if (keyNow != undefined && keyNow !== which) {
    keyNow=which;
    lastChangeTime =  timeFromStart;
  }
  if(GroupA.children[0].position.distanceTo(GroupA.children[1].position)<=3&&(Math.abs(GroupD.children[0].rotation.z)<=0.0293||Math.abs(GroupD.children[0].rotation.z)>=3.14)){
  people[0][11].visible = true;
  people[0][12].visible = true;
  GroupA.children[2].visible = true;
  GroupA.children[4].visible = true;
  Drumkeyframe(clock.getElapsedTime());   
  people[0][3].rotation.y = intKey1[0];//gcontrol.theta1;
  people[0][4].rotation.y = intKey1[1];//gcontrol.theta2;
  people[0][5].rotation.y = intKey1[2];//gcontrol.theta3;
  people[0][6].rotation.y = intKey1[3];//gcontrol.theta4;
  people[0][7].rotation.y = intKey1[4];//gcontrol.theta5;
  people[0][8].rotation.y = intKey1[5];//gcontrol.theta6;
  people[0][9].rotation.y =intKey1[6];//gcontrol.theta7;
  people[0][10].rotation.y =intKey1[7];//gcontrol.theta8;
  people[0][1].rotation.y= intKey1[8];//gcontrol.theta9;
  people[0][2].rotation.y = intKey1[9];//gcontrol.theta10;
  people[0][4].rotation.z = intKey1[10];//gcontrol.theta11;
  people[0][6].rotation.z = intKey1[11];//gcontrol.theta12;
  ////////////////////////////////////////////////////////////
  if(people[0][4].rotation.y<0.013&&people[0][4].rotation.z>-0.002){
		collisionSound[1].play();
    }
    if(people[0][6].rotation.y<0.013&&people[0][6].rotation.z<0.002){
			collisionSound[1].play();
    }
    if(people[0][4].rotation.y<0.013&&people[0][4].rotation.z<-0.002){
			collisionSound[2].play();
    }
  	if(people[0][6].rotation.y<0.013&&people[0][6].rotation.z>0.002){
			collisionSound[2].play();
      }
  	
  soundVal += 0.003;
  soundVal = THREE.Math.clamp (soundVal, 0, 0.4);
	soundtrack.volume = soundVal;


		soundTrack.play()
	}
  else{
  	GroupA.children[4].visible = false;
  	people[0][11].visible = false;
    people[0][12].visible = false;
    GroupA.children[2].visible = false;
    people[0][3].rotation.y = 0;//gcontrol.theta1;
    people[0][4].rotation.y = 0;//gcontrol.theta2;
    people[0][5].rotation.y = 0;//gcontrol.theta3;
    people[0][6].rotation.y = 0;//gcontrol.theta4;
    people[0][7].rotation.y = 0;//gcontrol.theta5;
    people[0][8].rotation.y = 0;//gcontrol.theta6;
    people[0][9].rotation.y = 0;//gcontrol.theta7;
    people[0][10].rotation.y = 0;//gcontrol.theta8;
    people[0][1].rotation.y = 0;//gcontrol.theta9;
    people[0][2].rotation.y = 0;//gcontrol.theta10;
    people[0][4].rotation.z = 0;//gcontrol.theta11;
    people[0][6].rotation.z = 0;//gcontrol.theta12;
    soundTrack.pause();
  }
  
  if(GroupB.children[0].position.distanceTo(GroupB.children[1].position)<=3&&(Math.abs(GroupD.children[0].rotation.y)>=3.14||Math.abs(GroupD.children[0].rotation.y)<=0)){
  people[1][11].visible = true;
  people[1][12].visible = true;
  GroupB.children[3].visible = true;
  Cymbalkeyframe(clock.getElapsedTime()); 
  people[1][3].rotation.y =intKey2[0];// gcontrol.theta1;
  people[1][4].rotation.y =intKey2[1];// gcontrol.theta2;
  people[1][5].rotation.y = intKey2[2];// gcontrol.theta3;
  people[1][6].rotation.y =intKey2[3];// gcontrol.theta4;
  people[1][7].rotation.y = intKey2[4];// gcontrol.theta5;
  people[1][8].rotation.y = intKey2[5];// gcontrol.theta6;
  people[1][9].rotation.y =intKey2[6];// gcontrol.theta7;
  people[1][10].rotation.y =intKey2[7];// gcontrol.theta8;
  people[1][1].rotation.x= intKey2[8];// gcontrol.theta9;
  people[1][2].rotation.y = intKey2[9];// gcontrol.theta10;
  people[1][4].rotation.z = intKey2[10];// gcontrol.theta11;
  people[1][6].rotation.z = intKey2[11];// gcontrol.theta12;
  /////////////////////////////////
  if(people[1][6].rotation.z<-0.7175){
    	if(b%3==1) collisionSound[3].play();
      else collisionSound[4].play();
      b++;
    }
  soundVal2 += 0.003;
	soundtrack2.volume = soundVal2;

	soundVal2 = THREE.Math.clamp (soundVal2, 0, 0.4);
		soundTrack2.play()
    }
  else {
    people[1][11].visible = false;
  	people[1][12].visible = false;
    GroupB.children[3].visible = false;
    people[1][3].rotation.y =0;// gcontrol.theta1;
    people[1][4].rotation.y =0;// gcontrol.theta2;
    people[1][5].rotation.y = 0;// gcontrol.theta3;
    people[1][6].rotation.y =0;// gcontrol.theta4;
    people[1][7].rotation.y = 0;// gcontrol.theta5;
    people[1][8].rotation.y = 0;// gcontrol.theta6;
    people[1][9].rotation.y =0;// gcontrol.theta7;
    people[1][10].rotation.y =0;// gcontrol.theta8;
    people[1][1].rotation.x= 0;// gcontrol.theta9;
    people[1][2].rotation.y = 0;// gcontrol.theta10;
    people[1][4].rotation.z = 0;// gcontrol.theta11;
    people[1][6].rotation.z = 0;// gcontrol.theta12;
    soundTrack2.pause();
  }
  
  if(GroupC.children[0].position.distanceTo(GroupC.children[1].position)<=3&&(Math.abs(GroupD.children[0].rotation.z)<=0.0293||Math.abs(GroupD.children[0].rotation.z)>=3.14)){
  people[2][11].visible = true;
  people[2][12].visible = true;
  people[2][13].visible = true;
  GroupC.children[3].visible = true;
  Smallkeyframe(clock.getElapsedTime());   
  people[2][3].rotation.y = intKey3[0];//gcontrol.theta1;
  people[2][4].rotation.y = intKey3[1];//gcontrol.theta2;
  people[2][5].rotation.y = intKey3[2];//gcontrol.theta3;
  people[2][6].rotation.y = intKey3[3];//gcontrol.theta4;
  people[2][7].rotation.y = intKey3[4];//gcontrol.theta5;
  people[2][8].rotation.y = intKey3[5];//gcontrol.theta6;
  people[2][9].rotation.y = intKey3[6];//gcontrol.theta7;
  people[2][10].rotation.y =intKey3[7];//gcontrol.theta8;
  people[2][1].rotation.y = intKey3[8];//gcontrol.theta9;
  people[2][2].rotation.y = intKey3[9];//gcontrol.theta10;
  people[2][3].rotation.z = intKey3[10];//gcontrol.theta11;
  people[2][5].rotation.z = intKey3[11];//gcontrol.theta12;
  people[2][4].rotation.x = intKey3[12];//gcontrol.theta13;
  people[2][6].rotation.x = intKey3[13];//gcontrol.theta14;
  /////////////////////////////////////
      
    if(people[2][4].rotation.x>1.7){
			collisionSound[5].play();
    }
  	if(people[2][6].rotation.x<-1.7){
			collisionSound[5].play();
    }

  soundVal3 += 0.003;
	soundtrack3.volume = soundVal3;

	soundVal3 = THREE.Math.clamp (soundVal3, 0, 0.3);
	soundTrack3.play()
	}
  else{
  	people[2][11].visible = false;
    people[2][12].visible = false;
    people[2][13].visible = false;
    GroupC.children[3].visible = false;
    people[2][3].rotation.y = 0;
    people[2][4].rotation.y = 0;
    people[2][5].rotation.y = 0;
    people[2][6].rotation.y = 0;
    people[2][7].rotation.y = 0;
    people[2][8].rotation.y = 0;
    people[2][9].rotation.y = 0;
    people[2][10].rotation.y = 0;
    people[2][1].rotation.y = 0;
    people[2][2].rotation.y = 0;
    people[2][3].rotation.z = -Math.PI/2;
    people[2][5].rotation.z = -Math.PI/2;
    people[2][4].rotation.x = 0;
    people[2][6].rotation.x = 0;
    soundTrack3.pause();
  }
  
  if(GroupE.children[0].position.distanceTo(GroupE.children[1].position)<=3&&(Math.abs(GroupD.children[0].rotation.y)<=Math.PI/2||Math.abs(GroupD.children[0].rotation.y)>=4.7)){
  test = 1;
  GroupA.children[0].visible = true;
  people[0][11].visible = true;
  people[0][12].visible = true;
  GroupB.children[0].visible = true;
  people[1][11].visible = true;
  people[1][12].visible = true;
  GroupC.children[0].visible = true;
  people[2][11].visible = true;
  people[2][12].visible = true;
  people[2][13].visible = true;

  GroupE.children[3].visible = true;
  GroupE.children[4].visible = true;
  GroupE.children[5].visible = true;
  GroupA.children[0].position.set(-L/2+50,-80,-L/2);
  GroupB.children[0].position.set(-L/2,-L/2,L/2-40);
  GroupC.children[0].position.set(L/2-40,-L+80,L/2);
  Drumkeyframe2(clock.getElapsedTime());   
  people[0][3].rotation.y = intKey[0];
  people[0][4].rotation.y = intKey[1];
  people[0][5].rotation.y = intKey[2];
  people[0][6].rotation.y = intKey[3];
  people[0][7].rotation.y = intKey[4];
  people[0][8].rotation.y = intKey[5];
  people[0][9].rotation.y = intKey[6];
  people[0][10].rotation.y = intKey[7];
  people[0][1].rotation.y = intKey[8];
  people[0][2].rotation.y = intKey[9];
  if(people[0][4].rotation.y<0.013){
		collisionSound[1].play();
  }
  if(people[0][6].rotation.y<0.013){
		collisionSound[1].play();
  }
  /////////////////////////
  Cymbalkeyframe2(clock.getElapsedTime()); 
  people[1][3].rotation.y =intKey2[0];
  people[1][4].rotation.y =intKey2[1];
  people[1][5].rotation.y = intKey2[2];
  people[1][6].rotation.y =intKey2[3];
  people[1][7].rotation.y = intKey2[4];
  people[1][8].rotation.y = intKey2[5];
  people[1][9].rotation.y =intKey2[6];
  people[1][10].rotation.y =intKey2[7];
  people[1][1].rotation.x= intKey2[8];
  people[1][2].rotation.y = intKey2[9];
  people[1][4].rotation.z = intKey2[10];
  people[1][6].rotation.z = intKey2[11];
  if(people[1][6].rotation.z<-0.7175){
    	collisionSound[3].play();
    }
  /////////////////////////
  Smallkeyframe2(clock.getElapsedTime()); 
  people[2][3].rotation.y = intKey3[0];
  people[2][4].rotation.y = intKey3[1];
  people[2][5].rotation.y = intKey3[2];
  people[2][6].rotation.y = intKey3[3];
  people[2][7].rotation.y = intKey3[4];
  people[2][8].rotation.y = intKey3[5];
  people[2][9].rotation.y = intKey3[6];
  people[2][10].rotation.y= intKey3[7];
  people[2][1].rotation.y = intKey3[8];
  people[2][2].rotation.y = intKey3[9];
 	people[2][3].rotation.z= intKey3[10];
  people[2][5].rotation.z= intKey3[11];
 	people[2][4].rotation.x= intKey3[12];
  people[2][6].rotation.x= intKey3[13];
  if(people[2][4].rotation.x>1.7){
			collisionSound[5].play();
    }
 if(people[2][6].rotation.x<-1.7){
			collisionSound[5].play();
    }
  /////////////////////////
  piano[1].rotation.x-=0.00525;
  piano[2].rotation.x-=0.0212;
  Pmankeyframe(clock.getElapsedTime());   
  people[4][3].rotation.y = intKey4[0];
  people[4][4].rotation.y = intKey4[1];
  people[4][5].rotation.y = intKey4[2];
  people[4][6].rotation.y = intKey4[3];
  people[4][7].rotation.y = intKey4[4];
  people[4][8].rotation.y = intKey4[5];
  people[4][9].rotation.y =intKey4[6];
  people[4][10].rotation.y =intKey4[7];
  people[4][1].rotation.y= intKey4[8];
  people[4][2].rotation.y = intKey4[9];
  people[4][4].rotation.z = intKey4[10];
  people[4][6].rotation.z = intKey4[11];
  /////////////////////////////////
  keyframe5(clock.getElapsedTime());   
  piano[3].rotation.x = intKey5[0];
  piano[4].rotation.x = intKey5[1];
  piano[5].rotation.x = intKey5[2];
  piano[6].rotation.x = intKey5[3];
  piano[7].rotation.x = intKey5[4];
  piano[8].rotation.x = intKey5[5];
  piano[9].rotation.x =intKey5[6];
  piano[10].rotation.x =intKey5[7];
  piano[11].rotation.x =intKey5[8];
  piano[12].rotation.x =intKey5[9];
    if(piano[3].rotation.x>0.19){
      collisionSound[6].play();
    }
    if(piano[4].rotation.x>0.19){
      collisionSound[7].play();
    }
    if(piano[5].rotation.x>0.19){
      collisionSound[8].play();
    }
    if(piano[6].rotation.x>0.19){
      collisionSound[9].play();
    }
    if(piano[7].rotation.x>0.19){
      collisionSound[10].play();
    }
    if(piano[8].rotation.x>0.19){
      collisionSound[11].play();
    }
    if(piano[9].rotation.x>0.19){
      collisionSound[12].play();
    }
    if(piano[10].rotation.x>0.19){
      collisionSound[13].play();
    }
    if(piano[11].rotation.x>0.19){
      collisionSound[14].play();
    }
    if(piano[12].rotation.x>0.19){
      collisionSound[15].play();
    }
	}
  else{
  	if(test){
      GroupA.children[0].visible = false;
      people[0][11].visible = false;
      people[0][12].visible = false;
      GroupB.children[0].visible = false;
      people[1][11].visible = false;
      people[1][12].visible = false;
      GroupC.children[0].visible = false;
      people[2][11].visible = false;
      people[2][12].visible = false;
      people[2][13].visible = false;
      test = 0;
    }
    GroupE.children[3].visible = false;
    GroupE.children[4].visible = false;
    GroupE.children[5].visible = false;
  	people[4][3].rotation.y = 0;
    people[4][4].rotation.y = 0;
    people[4][5].rotation.y = 0;
    people[4][6].rotation.y = 0;
    people[4][7].rotation.y = 0;
    people[4][8].rotation.y = 0;
    people[4][9].rotation.y = 0;
    people[4][10].rotation.y = 0;
    people[4][1].rotation.y = 0;
    people[4][2].rotation.y = 0;
    people[4][4].rotation.z = 0;
    people[4][6].rotation.z = 0;
  }
  
  if (eT==3&&which == 'B'&&manIn=='A') {
    //currentPlane = 'A';
    //nextPlane = 'B';
      pos1[0] = new THREE.Vector3(0, 0, 0);  // starting pos
      euler1[0] = new THREE.Euler (0, 0, 0, 'ZYX');// starting orientation
      euler2[0] = new THREE.Euler (0, 0, -Math.PI/2,'ZYX');

      pos1[1] = new THREE.Vector3(0,-L/2, L/2);
      euler1[1] = new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX');
      euler2[1] = new THREE.Euler (0, Math.PI/2, 0,'ZYX');

      pos1[2] = new THREE.Vector3(0,-L, 0);
      euler1[2] = new THREE.Euler (Math.PI, 0, 0, 'ZYX');
      euler2[2] = new THREE.Euler (0, Math.PI, -Math.PI/2,'ZYX');

      pos1[3] = new THREE.Vector3(0,-L/2, L/2);
      euler1[3] = new THREE.Euler (Math.PI/2, 0, -Math.PI/2, 'ZYX');
      euler2[3] = new THREE.Euler (0, Math.PI/2, Math.PI,'ZYX');

      pos1[4] = new THREE.Vector3(0,-L/2, L/2);
      euler1[4] = new THREE.Euler (Math.PI/2, 0, 0, 'ZYX');
      euler2[4] = new THREE.Euler (0, Math.PI/2, -Math.PI/2,'ZYX');

      pos1[5] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[5] = new THREE.Euler (-Math.PI/2, 0, 0, 'ZYX');
      euler2[5] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2,'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2, Math.PI, 0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (Math.PI/2, 0, 0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0, Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0, -Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning	
      manIn ='B';
      moving = 'AtoB';
		}
  if (eT==3&&which == 'E'&&manIn=='A') { 
    //currentPlane = 'A';
    //nextPlane = 'E';
      pos1[0] = new THREE.Vector3(0,0, 0);
      euler1[0] = new THREE.Euler (0, Math.PI/2, 0, 'ZYX');
      euler2[0] = new THREE.Euler (-Math.PI/2,0, -Math.PI/2, 'ZYX');

      pos1[1] = new THREE.Vector3(0,- L/2, L/2);
      euler1[1] = new THREE.Euler (-Math.PI/2, Math.PI, 0, 'ZYX');
      euler2[1] = new THREE.Euler (0, Math.PI/2, Math.PI/2, 'ZYX');

      pos1[2] = new THREE.Vector3(0,-L, 0);
      euler1[2] = new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX');
      euler2[2] = new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX');

      pos1[3] = new THREE.Vector3(0,-L/2, L/2);
      euler1[3] = new THREE.Euler (Math.PI/2, 0, 0, 'ZYX');
      euler2[3] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');

      pos1[4] = new THREE.Vector3(0,-L/2, L/2);
      euler1[4] = new THREE.Euler (Math.PI/2,0, Math.PI/2, 'ZYX');
      euler2[4] = new THREE.Euler (0,Math.PI/2, 0, 'ZYX');

      pos1[5] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[5] = new THREE.Euler (-Math.PI/2,0, -Math.PI/2, 'ZYX');
      euler2[5] = new THREE.Euler (0,-Math.PI/2, Math.PI, 'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2, Math.PI, 0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (Math.PI/2, 0, 0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0, Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0, -Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning		
      manIn = 'E';
      moving = 'AtoE';
		}
  if (eT==3&&which == 'C'&&manIn=='A') { 
    //currentPlane = 'A';
    //nextPlane = 'C';
      pos1[0] = new THREE.Vector3(0, 0, 0);  // starting pos
      euler1[0] = new THREE.Euler (0, 0, 0, 'ZYX');// starting orientation
      euler2[0] = new THREE.Euler (0, 0, -Math.PI/2,'ZYX');

      pos1[1] = new THREE.Vector3(0,-L/2, L/2);
      euler1[1] = new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX');
      euler2[1] = new THREE.Euler (0, Math.PI/2, 0,'ZYX');

      pos1[2] = new THREE.Vector3(0,-L, 0);
      euler1[2] = new THREE.Euler (Math.PI, 0, 0, 'ZYX');
      euler2[2] = new THREE.Euler (0, Math.PI, -Math.PI/2,'ZYX');

      pos1[3] = new THREE.Vector3(0,-L/2, L/2);
      euler1[3] = new THREE.Euler (Math.PI/2, 0, -Math.PI/2, 'ZYX');
      euler2[3] = new THREE.Euler (0, Math.PI/2, Math.PI,'ZYX');

      pos1[4] = new THREE.Vector3(0,-L/2, L/2);
      euler1[4] = new THREE.Euler (Math.PI/2, 0, 0, 'ZYX');
      euler2[4] = new THREE.Euler (0, Math.PI/2, -Math.PI/2,'ZYX');

      pos1[5] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[5] = new THREE.Euler (-Math.PI/2, 0, 0, 'ZYX');
      euler2[5] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2,'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2, Math.PI, 0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (Math.PI/2, 0, 0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0, Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0, -Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning
      change = 0;
      manIn ='C';
      moving = 'AtoC';
		}
  /////////////
 	if (eT==3&&which == 'C'&&manIn=='B') {  
    //currentPlane = 'B';
    //nextPlane = 'C';
      pos1[0] = new THREE.Vector3(L/2, -L/2, 0);
      euler1[0] = new THREE.Euler (0, 0, -Math.PI/2, 'ZYX'); 
      euler2[0] = new THREE.Euler (0, 0, -Math.PI, 'ZYX');

      pos1[1] = new THREE.Vector3(0,0, 0);
      euler1[1] = new THREE.Euler (0, Math.PI/2, 0, 'ZYX');
      euler2[1] = new THREE.Euler (-Math.PI/2, 0, -Math.PI/2,'ZYX');

      pos1[2] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[2] = new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX');
      euler2[2] = new THREE.Euler (0, Math.PI, 0,'ZYX');

      pos1[3] = new THREE.Vector3(0,-L, 0);
      euler1[3] = new THREE.Euler (0, Math.PI/2, Math.PI, 'ZYX');
      euler2[3] = new THREE.Euler (-Math.PI/2, 0, Math.PI/2,'ZYX');

      pos1[4] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[4] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[4] = new THREE.Euler (Math.PI/2, Math.PI, 0,'ZYX');

      pos1[5] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[5] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[5] = new THREE.Euler (-Math.PI/2, Math.PI, 0,'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (0, Math.PI,0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (0, Math.PI, Math.PI, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (0,0, -Math.PI/2, 'ZYX'));

      turning = 0; //not yet turning	
      manIn = 'C';
      moving = 'BtoC';
		}
  if (eT==3&&which == 'E'&&manIn=='B') {  
    //currentPlane = 'B';
    //nextPlane = 'E';
      pos1[0] = new THREE.Vector3(L/2, -L/2, 0);
      euler1[0] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[0] = new THREE.Euler (-Math.PI/2, 0, Math.PI, 'ZYX');

      pos1[1] = new THREE.Vector3(0, 0, 0);
      euler1[1] = new THREE.Euler (0, Math.PI,0, 'ZYX');
      euler2[1] = new THREE.Euler (0,Math.PI, Math.PI/2, 'ZYX');

      pos1[2] = new THREE.Vector3(L/2, -L/2, 0);
      euler1[2] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[2] = new THREE.Euler (Math.PI/2, 0, Math.PI, 'ZYX');

      pos1[3] = new THREE.Vector3(0,-L, 0);
      euler1[3] = new THREE.Euler (0, Math.PI, Math.PI, 'ZYX');
      euler2[3] = new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX');

      pos1[4] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[4] = new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX');
      euler2[4] = new THREE.Euler (0, Math.PI, 0, 'ZYX');

      pos1[5] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[5] = new THREE.Euler (0,0, -Math.PI/2, 'ZYX');
      euler2[5] = new THREE.Euler (0,0, -Math.PI, 'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (0, Math.PI,0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (0, Math.PI, Math.PI, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (0,0, -Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning		
      moving = 'BtoE';
      manIn = 'E';
		}
  if (eT==3&&which == 'A'&&manIn=='B') {  
    //currentPlane = 'B';
    //nextPlane = 'A';
      pos1[0] = new THREE.Vector3(L/2, -L/2, 0);
      euler1[0] = new THREE.Euler (0,Math.PI, -Math.PI/2, 'ZYX');
      euler2[0] = new THREE.Euler (0,Math.PI, 0, 'ZYX');

      pos1[1] = new THREE.Vector3(0, 0, 0);
      euler1[1] = new THREE.Euler (0,-Math.PI/2, 0, 'ZYX');
      euler2[1] = new THREE.Euler (Math.PI/2,0, -Math.PI/2, 'ZYX');

      pos1[2] = new THREE.Vector3(L/2, -L/2, 0);
      euler1[2] = new THREE.Euler (0, 0, -Math.PI/2, 'ZYX');
      euler2[2] = new THREE.Euler (0, 0, -Math.PI, 'ZYX');

      pos1[3] = new THREE.Vector3(0,-L, 0);
      euler1[3] = new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX');
      euler2[3] = new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX');

      pos1[4] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[4] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[4] = new THREE.Euler (Math.PI/2, 0, -Math.PI, 'ZYX');

      pos1[5] = new THREE.Vector3(L/2,-L/2, 0);
      euler1[5] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');
      euler2[5] = new THREE.Euler (-Math.PI/2, 0, Math.PI, 'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (0, Math.PI,0, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (0, Math.PI, Math.PI, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (0,0, -Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning	
      manIn ='A';
      moving = 'BtoA';
		}
  //////////////
  if (eT==3&&which == 'E'&&manIn=='C') {  
    //currentPlane = 'C';
    //nextPlane = 'E';
      pos1[0] = new THREE.Vector3(0,-L, 0);
      euler1[0] = new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX');
      euler2[0] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');

      pos1[1] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[1] = new THREE.Euler (-Math.PI/2,0,Math.PI, 'ZYX');
      euler2[1] = new THREE.Euler (0,-Math.PI/2,Math.PI/2, 'ZYX');

      pos1[2] = new THREE.Vector3(0, 0, 0);
      euler1[2] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');
      euler2[2] = new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX');

      pos1[3] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[3] = new THREE.Euler (-Math.PI/2,0,0, 'ZYX');
      euler2[3] = new THREE.Euler (0,-Math.PI/2,-Math.PI/2, 'ZYX');

      pos1[4] = new THREE.Vector3(0,-L/2, -L/2);
      euler1[4] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');
      euler2[4] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');

      pos1[5] = new THREE.Vector3(0,-L/2, L/2);
      euler1[5] = new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX');
      euler2[5] = new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX');

      GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,0, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX'));
      turning = 0; //not yet turning		
      manIn = 'E';
      moving = 'CtoE';
		}
  if (eT==3&&which == 'B'&&manIn=='C') {  
    //currentPlane = 'C';
    //nextPlane = 'B';
    pos1[0] = new THREE.Vector3(0,-L, 0);
    euler1[0] = new THREE.Euler (0,Math.PI,Math.PI, 'ZYX');
    euler2[0] = new THREE.Euler (0,Math.PI,-Math.PI/2, 'ZYX');

 		pos1[1] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[1] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');
    euler2[1] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');
    
    pos1[2] = new THREE.Vector3(0, 0, 0);
    euler1[2] = new THREE.Euler (0,0,0, 'ZYX');
    euler2[2] = new THREE.Euler (0,0,-Math.PI/2, 'ZYX');
    
    pos1[3] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[3] = new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX');
    euler2[3] = new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX');
    
    pos1[4] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[4] = new THREE.Euler (-Math.PI/2,0,0, 'ZYX');
    euler2[4] = new THREE.Euler (0,-Math.PI/2,-Math.PI/2, 'ZYX');
    
    pos1[5] = new THREE.Vector3(0,-L/2, L/2);
    euler1[5] = new THREE.Euler (Math.PI/2,0,0, 'ZYX');
    euler2[5] = new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX');

    GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,0, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX'));
    turning = 0; //not yet turning		
		manIn = 'B';
    moving = 'CtoB'; 
  }
  if (eT==3&&which == 'A'&&manIn=='C') {  
    //currentPlane = 'C';
    //nextPlane = 'A';
    pos1[0] = new THREE.Vector3(0,-L, 0);
    euler1[0] = new THREE.Euler (0,Math.PI,Math.PI, 'ZYX');
    euler2[0] = new THREE.Euler (0,Math.PI,-Math.PI/2, 'ZYX');

 		pos1[1] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[1] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');
    euler2[1] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');
    
    pos1[2] = new THREE.Vector3(0, 0, 0);
    euler1[2] = new THREE.Euler (0,0,0, 'ZYX');
    euler2[2] = new THREE.Euler (0,0,-Math.PI/2, 'ZYX');
    
    pos1[3] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[3] = new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX');
    euler2[3] = new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX');
    
    pos1[4] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[4] = new THREE.Euler (-Math.PI/2,0,0, 'ZYX');
    euler2[4] = new THREE.Euler (0,-Math.PI/2,-Math.PI/2, 'ZYX');
    
    pos1[5] = new THREE.Vector3(0,-L/2, L/2);
    euler1[5] = new THREE.Euler (Math.PI/2,0,0, 'ZYX');
    euler2[5] = new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX');

    GroupA.children[0].position.copy (pos1[0]);
      GroupA.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX'));
      GroupB.children[0].position.copy (pos1[1]);
      GroupB.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI, 'ZYX'));
      GroupC.children[0].position.copy (pos1[2]);
      GroupC.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,0, 'ZYX'));
      GroupD.children[0].position.copy (pos1[3]);
      GroupD.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,0, 'ZYX'));
      GroupE.children[0].position.copy (pos1[4]);
      GroupE.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX'));
      GroupF.children[0].position.copy (pos1[5]);
      GroupF.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX'));
    turning = 0; //not yet turning		
    change = 0;
		manIn = 'A';
    moving = 'CtoA'; 
  }
  //////////////
  if (eT==3&&which == 'A'&&manIn=='E') {
    //currentPlane = 'E';
    //nextPlane = 'A';
    pos1[0] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[0] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');
    euler2[0] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');

 		pos1[1] = new THREE.Vector3(-L/2,-L/2, 0);
    euler1[1] = new THREE.Euler (0,-Math.PI/2,Math.PI/2, 'ZYX');
    euler2[1] = new THREE.Euler (Math.PI/2,0,0, 'ZYX');
    
    pos1[2] = new THREE.Vector3(0,-L/2, L/2);
    euler1[2] = new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX');
    euler2[2] = new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX');
    
    pos1[3] = new THREE.Vector3(L/2,-L/2, 0);
    euler1[3] = new THREE.Euler (0,-Math.PI/2,-Math.PI/2, 'ZYX');
    euler2[3] = new THREE.Euler (-Math.PI/2,Math.PI,0, 'ZYX');
    
    pos1[4] = new THREE.Vector3(0,0, 0);
    euler1[4] = new THREE.Euler (0,-Math.PI/2,0, 'ZYX');
    euler2[4] = new THREE.Euler (Math.PI/2,0,-Math.PI/2, 'ZYX');
    
    pos1[5] = new THREE.Vector3(0,-L,0);
    euler1[5] = new THREE.Euler (0,Math.PI/2,Math.PI, 'ZYX');
    euler2[5] = new THREE.Euler (-Math.PI/2,0,Math.PI/2, 'ZYX');

    GroupA.children[0].position.copy (pos1[0]);
    GroupA.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX'));
    GroupB.children[0].position.copy (pos1[1]);
    GroupB.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI/2, 'ZYX'));
    GroupC.children[0].position.copy (pos1[2]);
    GroupC.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,Math.PI/2, 'ZYX'));
    GroupD.children[0].position.copy (pos1[3]);
    GroupD.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX'));
    GroupE.children[0].position.copy (pos1[4]);
    GroupE.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
    GroupF.children[0].position.copy (pos1[5]);
    GroupF.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX'));
    turning = 0; //not yet turning		
		manIn = 'A';
    moving = 'EtoA'; 
  }
  if (eT==3&&which == 'B'&&manIn=='E') {
    //currentPlane = 'E';
    //nextPlane = 'B';
    pos1[0] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[0] = new THREE.Euler (-Math.PI/2,0,0, 'ZYX');
    euler2[0] = new THREE.Euler (0,-Math.PI/2,-Math.PI/2, 'ZYX');

 		pos1[1] = new THREE.Vector3(-L/2,-L/2, 0);
    euler1[1] = new THREE.Euler (0,0,Math.PI/2, 'ZYX');
    euler2[1] = new THREE.Euler (0,0,0, 'ZYX');
    
    pos1[2] = new THREE.Vector3(0,-L/2, L/2);
    euler1[2] = new THREE.Euler (Math.PI/2,0,0, 'ZYX');
    euler2[2] = new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX');
    
    pos1[3] = new THREE.Vector3(L/2,-L/2, 0);
    euler1[3] = new THREE.Euler (0,0,-Math.PI/2, 'ZYX');
    euler2[3] = new THREE.Euler (0,0,Math.PI, 'ZYX');
    
    pos1[4] = new THREE.Vector3(0,0, 0);
    euler1[4] = new THREE.Euler (0,0,0, 'ZYX');
    euler2[4] = new THREE.Euler (0,0,-Math.PI/2, 'ZYX');
    
    pos1[5] = new THREE.Vector3(0,-L,0);
    euler1[5] = new THREE.Euler (0,Math.PI,Math.PI, 'ZYX');
    euler2[5] = new THREE.Euler (0,Math.PI,-Math.PI/2, 'ZYX');

    GroupA.children[0].position.copy (pos1[0]);
    GroupA.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX'));
    GroupB.children[0].position.copy (pos1[1]);
    GroupB.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI/2, 'ZYX'));
    GroupC.children[0].position.copy (pos1[2]);
    GroupC.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,Math.PI/2, 'ZYX'));
    GroupD.children[0].position.copy (pos1[3]);
    GroupD.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX'));
    GroupE.children[0].position.copy (pos1[4]);
    GroupE.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
    GroupF.children[0].position.copy (pos1[5]);
    GroupF.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX'));
    turning = 0; //not yet turning		
		manIn = 'B';
    moving = 'EtoB'; 
  }
  if (eT==3&&which == 'C'&&manIn=='E') {
    //currentPlane = 'E';
    //nextPlane = 'C';
    pos1[0] = new THREE.Vector3(0,-L/2, -L/2);
    euler1[0] = new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX');
    euler2[0] = new THREE.Euler (Math.PI,-Math.PI/2,0, 'ZYX');

 		pos1[1] = new THREE.Vector3(-L/2,-L/2, 0);
    euler1[1] = new THREE.Euler (0,Math.PI/2,Math.PI/2, 'ZYX');
    euler2[1] = new THREE.Euler (-Math.PI/2,0,0, 'ZYX');
    
    pos1[2] = new THREE.Vector3(0,-L/2, L/2);
    euler1[2] = new THREE.Euler (Math.PI/2,0,Math.PI/2, 'ZYX');
    euler2[2] = new THREE.Euler (0,Math.PI/2,0, 'ZYX');
    
    pos1[3] = new THREE.Vector3(L/2,-L/2, 0);
    euler1[3] = new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX');
    euler2[3] = new THREE.Euler (Math.PI/2,Math.PI,0, 'ZYX');
    
    pos1[4] = new THREE.Vector3(0,0, 0);
    euler1[4] = new THREE.Euler (0,Math.PI/2,0, 'ZYX');
    euler2[4] = new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX');
    
    pos1[5] = new THREE.Vector3(0,-L,0);
    euler1[5] = new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX');
    euler2[5] = new THREE.Euler (Math.PI/2,0,Math.PI/2, 'ZYX');

    GroupA.children[0].position.copy (pos1[0]);
    GroupA.children[0].rotation.copy (new THREE.Euler (-Math.PI/2,0,-Math.PI/2, 'ZYX'));
    GroupB.children[0].position.copy (pos1[1]);
    GroupB.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,Math.PI/2, 'ZYX'));
    GroupC.children[0].position.copy (pos1[2]);
    GroupC.children[0].rotation.copy (new THREE.Euler (Math.PI/2,0,Math.PI/2, 'ZYX'));
    GroupD.children[0].position.copy (pos1[3]);
    GroupD.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,-Math.PI/2, 'ZYX'));
    GroupE.children[0].position.copy (pos1[4]);
    GroupE.children[0].rotation.copy (new THREE.Euler (0,Math.PI/2,0, 'ZYX'));
    GroupF.children[0].position.copy (pos1[5]);
    GroupF.children[0].rotation.copy (new THREE.Euler (0,-Math.PI/2,Math.PI, 'ZYX'));
    turning = 0; //not yet turning		
		manIn = 'C';
    moving = 'EtoC'; 
  }
  //////////////
  if(eT>3&&moving == 'AtoE'&&manIn=='E')AtoE(); 
  if(eT>3&&moving == 'AtoB'&&manIn=='B')AtoB(); 
  if(eT>3&&moving == 'AtoC'&&manIn=='C')AtoC(); 
  
  if(eT>3&&moving == 'BtoC'&&manIn=='C')BtoC();
  if(eT>3&&moving == 'BtoE'&&manIn=='E')BtoE();
  if(eT>3&&moving == 'BtoA'&&manIn=='A')BtoA(); 
  
  if(eT>3&&moving == 'CtoE'&&manIn=='E')CtoE(); 
  if(eT>3&&moving == 'CtoB'&&manIn=='B')CtoB(); 
  if(eT>3&&moving == 'CtoA'&&manIn=='A')CtoA(); 
  
  if(eT>3&&moving == 'EtoA'&&manIn=='A')EtoA(); 
  if(eT>3&&moving == 'EtoB'&&manIn=='B')EtoB(); 
  if(eT>3&&moving == 'EtoC'&&manIn=='C')EtoC(); 
  
  //////////////////////////////////////////////
  requestAnimationFrame(animate);
  render();

}
function AtoB() {
var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y>0){
      GroupA.children[0].rotation.y -= 0.05;
      GroupB.children[0].rotation.z -= 0.05;
      GroupC.children[0].rotation.y -= 0.05;
      GroupD.children[0].rotation.z -= 0.05;
      GroupE.children[0].rotation.z -= 0.05;
      GroupF.children[0].rotation.z += 0.05;
    }
    else{
      GroupA.children[0].position.x += triStep;
      GroupB.children[0].position.y += triStep;
      GroupC.children[0].position.x += triStep;
      GroupD.children[0].position.y -= triStep;
      GroupE.children[0].position.x += triStep;
      GroupF.children[0].position.x += triStep;
		}
  	if (GroupA.children[0].position.x > L/2-L/kk&&GroupB.children[0].position.y > -L/kk&&GroupD.children[0].position.y<-L+L/kk) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2-L/kk, 0, 0);
      pos2[0] = new THREE.Vector3(L/2, 0, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      /////////////////////
      pos1[1] = new THREE.Vector3(0,-L/kk, L/2);
      pos2[1] = new THREE.Vector3(0, 0, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ////////////////////
      pos1[2] = new THREE.Vector3(L/2-L/kk,-L, 0);
      pos2[2] = new THREE.Vector3(L/2,-L, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ////////////////////
      pos1[3] = new THREE.Vector3(0,-L+L/kk, L/2);
      pos2[3] = new THREE.Vector3(0,-L, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2-L/kk,-L/2, L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2-L/kk,-L/2, -L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[0][13].visible = false;
    people[1][13].visible = false;
    
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
  	if (GroupD.children[0].position.z<0) {
      if(GroupA.children[0].rotation.y<Math.PI/2){
      GroupA.children[0].rotation.y += 0.05;
      GroupB.children[0].rotation.y += 0.05;
      GroupC.children[0].rotation.y += 0.05;
      GroupD.children[0].rotation.y += 0.05;
      GroupE.children[0].rotation.y += 0.05;
      GroupF.children[0].rotation.y += 0.05;
      }
      else moving = false;
    }
    else{
      GroupA.children[5].visible = true;
      GroupB.children[4].visible = false;
    	if(GroupD.children[0].position.z <= L/2-L/kk) people[1][13].visible = true;
    	GroupA.children[0].position.y -= triStep;
      GroupB.children[0].position.z -= triStep;
      GroupC.children[0].position.y += triStep;
      GroupD.children[0].position.z -= triStep;
      GroupE.children[0].position.z -= triStep;
      GroupF.children[0].position.z += triStep;
    }
  }
}
function AtoE() {
var triStep = .90;
  if (turning === 0) {
  	GroupA.children[0].position.z -= triStep;
    GroupB.children[0].position.x -= triStep;
    GroupC.children[0].position.z += triStep;
    GroupD.children[0].position.x += triStep;
    GroupE.children[0].position.y += triStep;
  	GroupF.children[0].position.y -= triStep;
  	if (GroupA.children[0].position.z < -L/2+L/kk&&GroupB.children[0].position.x < -L/2+L/kk&&GroupD.children[0].position.x>L/2-L/kk) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(0, 0, -L/2+L/kk);
      pos2[0] = new THREE.Vector3(0, 0, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      /////////////////
      pos1[1] = new THREE.Vector3(-L/2+L/kk,-L/2, L/2);
      pos2[1] = new THREE.Vector3(-L/2,-L/2, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      /////////////////
      pos1[2] = new THREE.Vector3(0,-L, L/2-L/kk);
      pos2[2] = new THREE.Vector3(0,-L, L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      /////////////////
      pos1[3] = new THREE.Vector3(L/2-L/kk,-L/2, L/2);
      pos2[3] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      /////////////////
      pos1[4] = new THREE.Vector3(0,-L/kk, L/2);
      pos2[4] = new THREE.Vector3(0,0, L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      /////////////////
      pos1[5] = new THREE.Vector3(0,-L+L/kk, -L/2);
      pos2[5] = new THREE.Vector3(0,-L, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      /////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
      
    }  

  } else if (turning === 1) { // in crossing
  	people[0][13].visible = false;
    people[4][11].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } 
  else { // turning == 2: finish crossing ... always a straight line
    GroupA.children[5].visible = true;
    GroupE.children[6].visible = false;
    if(GroupD.children[0].position.z<=L/2-L/kk){
  	people[4][11].visible = true;
    people[0][13].visible = true;
    people[1][13].visible = true;
    people[2][14].visible = true;
  }
	GroupA.children[0].position.y -= triStep;
  GroupB.children[0].position.z -= triStep;
  GroupC.children[0].position.y += triStep;
  GroupD.children[0].position.z -= triStep;
  GroupE.children[0].position.z -= triStep;
  GroupF.children[0].position.z += triStep;
  	if (GroupD.children[0].position.z<0) {
  		moving = false;
    }
  }
}
function AtoC(){
	var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y>0){
      GroupA.children[0].rotation.y -= 0.05;
      GroupB.children[0].rotation.z -= 0.05;
      GroupC.children[0].rotation.y -= 0.05;
      GroupD.children[0].rotation.z -= 0.05;
      GroupE.children[0].rotation.z -= 0.05;
      GroupF.children[0].rotation.z += 0.05;
    }
    else{
      GroupA.children[0].position.x += triStep;
      GroupB.children[0].position.y += triStep;
      GroupC.children[0].position.x += triStep;
      GroupD.children[0].position.y -= triStep;
      GroupE.children[0].position.x += triStep;
      GroupF.children[0].position.x += triStep;
		}
  	if (GroupA.children[0].position.x > L/2-L/kk&&GroupB.children[0].position.y > -L/kk&&GroupD.children[0].position.y<-L+L/kk) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2-L/kk, 0, 0);
      pos2[0] = new THREE.Vector3(L/2, 0, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      /////////////////////
      pos1[1] = new THREE.Vector3(0,-L/kk, L/2);
      pos2[1] = new THREE.Vector3(0, 0, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ////////////////////
      pos1[2] = new THREE.Vector3(L/2-L/kk,-L, 0);
      pos2[2] = new THREE.Vector3(L/2,-L, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ////////////////////
      pos1[3] = new THREE.Vector3(0,-L+L/kk, L/2);
      pos2[3] = new THREE.Vector3(0,-L, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2-L/kk,-L/2, L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2-L/kk,-L/2, -L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[0][13].visible = false;
    people[1][13].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } 
  else if(turning ===2){

  	if (GroupD.children[0].position.z> -L/2) {
      GroupA.children[5].visible = true;
      GroupB.children[4].visible = false;
    	if(GroupD.children[0].position.z<=L/2-L/kk)people[1][13].visible = true;
      GroupA.children[0].position.y -= triStep;
      GroupB.children[0].position.z -= triStep;
      GroupC.children[0].position.y += triStep;
      GroupD.children[0].position.z -= triStep;
      GroupE.children[0].position.z -= triStep;
      GroupF.children[0].position.z += triStep;
    }
    else if (GroupD.children[0].position.z<-L/2) {// ready to cross
    	if(change == 0){
        euler1[0] = new THREE.Euler (0, 0, -Math.PI/2, 'ZYX'); 
        euler2[0] = new THREE.Euler (0, 0, -Math.PI, 'ZYX');

        euler1[1] = new THREE.Euler (0, Math.PI/2, 0, 'ZYX');
        euler2[1] = new THREE.Euler (-Math.PI/2, 0, -Math.PI/2,'ZYX');

        euler1[2] = new THREE.Euler (0, Math.PI, -Math.PI/2, 'ZYX');
        euler2[2] = new THREE.Euler (0, Math.PI, 0,'ZYX');

        euler1[3] = new THREE.Euler (0, Math.PI/2, Math.PI, 'ZYX');
        euler2[3] = new THREE.Euler (-Math.PI/2, 0, Math.PI/2,'ZYX');

        euler1[4] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');
        euler2[4] = new THREE.Euler (Math.PI/2, Math.PI, 0,'ZYX');

        euler1[5] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX');
        euler2[5] = new THREE.Euler (-Math.PI/2, Math.PI, 0,'ZYX');
        change = 1;
      }
      turning = 3;
      pos1[0] = new THREE.Vector3(L/2, -L, 0);
      pos2[0] = new THREE.Vector3(L/2, -L, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0,0, -L/2);
      pos2[1] = new THREE.Vector3(0,0, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2,0, 0);
      pos2[2] = new THREE.Vector3(L/2,0, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L, -L/2);
      pos2[3] = new THREE.Vector3(0,-L, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }
    else{

    	if (GroupD.children[0].position.y>-L/2){
        if(GroupA.children[0].rotation.y<Math.PI/2){
          
          GroupA.children[0].rotation.y += 0.05;
          GroupB.children[0].rotation.z -= 0.05;
          GroupC.children[0].rotation.y += 0.05;
          GroupD.children[0].rotation.z -= 0.05;
          GroupE.children[0].rotation.z -= 0.05;
          GroupF.children[0].rotation.z += 0.05;
         }
        else moving = false;
      }
      else{
        GroupB.children[4].visible = true;
        GroupC.children[4].visible = false;
        if(GroupD.children[0].position.y>=-L+L/kk)people[2][14].visible = true;
        GroupA.children[0].position.x -= triStep;
        GroupB.children[0].position.y -= triStep;
        GroupC.children[0].position.x -= triStep;
        GroupD.children[0].position.y += triStep;
        GroupE.children[0].position.x -= triStep;
        GroupF.children[0].position.x -= triStep;
      }

    }
  }
  else if (turning === 3) { // in crossing
  	people[1][13].visible = false;
    people[2][14].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  }
}

function BtoC() {
var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y>0){
      	GroupA.children[0].rotation.y -= 0.05;
      	GroupB.children[0].rotation.y -= 0.05;
        GroupC.children[0].rotation.y -= 0.05;
        GroupD.children[0].rotation.y -= 0.05;
        GroupE.children[0].rotation.y -= 0.05;
        GroupF.children[0].rotation.y -= 0.05;
    }
    else{
      GroupA.children[0].position.y -= triStep;
      GroupB.children[0].position.z -= triStep;
      GroupC.children[0].position.y += triStep;
      GroupD.children[0].position.z -= triStep;
      GroupE.children[0].position.z -= triStep;
      GroupF.children[0].position.z += triStep;
  	}
  	if (GroupA.children[0].position.y < -L&&GroupD.children[0].position.z<-L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2, -L, 0);
      pos2[0] = new THREE.Vector3(L/2, -L, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0,0, -L/2);
      pos2[1] = new THREE.Vector3(0,0, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2,0, 0);
      pos2[2] = new THREE.Vector3(L/2,0, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L, -L/2);
      pos2[3] = new THREE.Vector3(0,-L, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[1][13].visible = false;
    people[2][14].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } 
  else { // turning == 2: finish crossing ... always a straight line
    GroupB.children[4].visible = true;
    GroupC.children[4].visible = false;
    if (GroupD.children[0].position.y>-L/2){
      if(GroupA.children[0].rotation.y<Math.PI/2){
      	
      	GroupA.children[0].rotation.y += 0.05;
      	GroupB.children[0].rotation.z -= 0.05;
        GroupC.children[0].rotation.y += 0.05;
        GroupD.children[0].rotation.z -= 0.05;
        GroupE.children[0].rotation.z -= 0.05;
        GroupF.children[0].rotation.z += 0.05;
       }
       else moving = false;
    }
    else{
    if(GroupD.children[0].position.y>=-L+L/kk)people[2][14].visible = true;
    GroupA.children[0].position.x -= triStep;
    GroupB.children[0].position.y -= triStep;
    GroupC.children[0].position.x -= triStep;
    GroupD.children[0].position.y += triStep;
    GroupE.children[0].position.x -= triStep;
    GroupF.children[0].position.x -= triStep;
    }
  }
}
function BtoE() {
var triStep = .90;
  if (turning === 0) {
  	GroupA.children[0].position.z -= triStep;
  	GroupB.children[0].position.x -= triStep;
    GroupC.children[0].position.z += triStep;
  	GroupD.children[0].position.x += triStep;
    GroupE.children[0].position.y += triStep;
  	GroupF.children[0].position.y -= triStep;
  	if (GroupA.children[0].position.z < -L/2&&GroupD.children[0].position.x>L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2, -L/2, -L/2);
      pos2[0] = new THREE.Vector3(L/2, -L/2, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(-L/2, 0, 0);
      pos2[1] = new THREE.Vector3(-L/2, 0, 0);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2, -L/2, L/2);
      pos2[2] = new THREE.Vector3(L/2, -L/2, L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(L/2, -L, 0);
      pos2[3] = new THREE.Vector3(L/2,-L, 0);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,0, 0);
      pos2[4] = new THREE.Vector3(L/2,0, 0);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L, 0);
      pos2[5] = new THREE.Vector3(L/2,-L, 0);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[1][13].visible = false;
    people[4][11].visible = false;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupB.children[4].visible = true;
    GroupE.children[6].visible = false;
  	if (GroupD.children[0].position.y>-L/2){
  		
      if(GroupA.children[0].rotation.z<Math.PI+Math.PI/2){
      	GroupA.children[0].rotation.z += 0.05;
      	GroupB.children[0].rotation.y -= 0.05;
        GroupC.children[0].rotation.z -= 0.05;
        GroupD.children[0].rotation.y -= 0.05;
        GroupE.children[0].rotation.y -= 0.05;
        GroupF.children[0].rotation.y -= 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.y>= -L+L/kk){
      	people[0][13].visible = true;
        people[1][13].visible = true;
        people[2][14].visible = true;
        people[4][11].visible = true;
      }
      GroupA.children[0].position.x -= triStep;
      GroupB.children[0].position.y -= triStep;
      GroupC.children[0].position.x -= triStep;
      GroupD.children[0].position.y += triStep;
      GroupE.children[0].position.x -= triStep;
      GroupF.children[0].position.x -= triStep;
    }
  }
}
function BtoA() {
var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y<Math.PI){
      	GroupA.children[0].rotation.y += 0.05;
      	GroupB.children[0].rotation.y += 0.05;
        GroupC.children[0].rotation.y += 0.05;
        GroupD.children[0].rotation.y += 0.05;
        GroupE.children[0].rotation.y += 0.05;
        GroupF.children[0].rotation.y += 0.05;
    }
    else{
      GroupA.children[0].position.y += triStep;
      GroupB.children[0].position.z += triStep;
      GroupC.children[0].position.y -= triStep;
      GroupD.children[0].position.z += triStep;
      GroupE.children[0].position.z += triStep;
      GroupF.children[0].position.z -= triStep;
  	}
  	if (GroupD.children[0].position.z>L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2, 0, 0);
      pos2[0] = new THREE.Vector3(L/2, 0, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0, 0, L/2);
      pos2[1] = new THREE.Vector3(0, 0, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2,-L, 0);
      pos2[2] = new THREE.Vector3(L/2,-L, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L, L/2);
      pos2[3] = new THREE.Vector3(0,-L, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  people[1][13].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupB.children[4].visible = true;
    GroupA.children[5].visible = false;
    if (GroupA.children[0].position.x < 0&&GroupD.children[0].position.y>-L/2){
      if(GroupA.children[0].rotation.y>Math.PI/2){
      	people[1][13].visible = true;
      	GroupA.children[0].rotation.y -= 0.05;
      	GroupB.children[0].rotation.z -= 0.05;
        GroupC.children[0].rotation.y -= 0.05;
        GroupD.children[0].rotation.z -= 0.05;
        GroupE.children[0].rotation.z -= 0.05;
        GroupF.children[0].rotation.z += 0.05;
       }
       else moving = false;
    }
    else{
    GroupA.children[0].position.x -= triStep;
    GroupB.children[0].position.y -= triStep;
    GroupC.children[0].position.x -= triStep;
    GroupD.children[0].position.y += triStep;
    GroupE.children[0].position.x -= triStep;
    GroupF.children[0].position.x -= triStep;
    }
  }
}

function CtoB() {
var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y<Math.PI){
      GroupA.children[0].rotation.y += 0.05;
      GroupB.children[0].rotation.z -= 0.05;
      GroupC.children[0].rotation.y += 0.05;
      GroupD.children[0].rotation.z -= 0.05;
      GroupE.children[0].rotation.z -= 0.05;
      GroupF.children[0].rotation.z += 0.05;
    }
    else{
      GroupA.children[0].position.x += triStep;
      GroupB.children[0].position.y += triStep;
      GroupC.children[0].position.x += triStep;
      GroupD.children[0].position.y -= triStep;
      GroupE.children[0].position.x += triStep;
      GroupF.children[0].position.x += triStep;
    }
  	if (GroupA.children[0].position.x > L/2-L/kk) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2-L/kk,-L, 0);
      pos2[0] = new THREE.Vector3(L/2,-L, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0,-L/kk, -L/2);
      pos2[1] = new THREE.Vector3(0,0, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2-L/kk,0, 0);
      pos2[2] = new THREE.Vector3(L/2,0, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L+L/kk, -L/2);
      pos2[3] = new THREE.Vector3(0,-L, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2-L/kk,-L/2, -L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2-L/kk,-L/2, L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[2][14].visible = false;
    people[1][13].visible = false;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
	
  	if (GroupD.children[0].position.z>0){
  		GroupC.children[4].visible = true;
      GroupB.children[4].visible = false;
      if(GroupA.children[0].rotation.y > Math.PI/2){
      	
      	GroupA.children[0].rotation.y -= 0.05;
      	GroupB.children[0].rotation.y -= 0.05;
        GroupC.children[0].rotation.y -= 0.05;
        GroupD.children[0].rotation.y -= 0.05;
        GroupE.children[0].rotation.y -= 0.05;
        GroupF.children[0].rotation.y -= 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.z>=-L/2+L/kk)people[1][13].visible = true;
      GroupA.children[0].position.y += triStep;
      GroupB.children[0].position.z += triStep;
      GroupC.children[0].position.y -= triStep;
      GroupD.children[0].position.z += triStep;
      GroupE.children[0].position.z += triStep;
      GroupF.children[0].position.z -= triStep;
    }
  }
}
function CtoE() {
var triStep = .90;
  if (turning === 0) {
  	GroupA.children[0].position.z -= triStep;
  	GroupB.children[0].position.x -= triStep;
    GroupC.children[0].position.z += triStep;
  	GroupD.children[0].position.x += triStep;
    GroupE.children[0].position.y += triStep;
  	GroupF.children[0].position.y -= triStep;
  	if (GroupA.children[0].position.z < -L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(0,-L, -L/2);
      pos2[0] = new THREE.Vector3(0,-L, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(-L/2,-L/2, -L/2);
      pos2[1] = new THREE.Vector3(-L/2,-L/2, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(0,0,L/2);
      pos2[2] = new THREE.Vector3(0,0,L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[3] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(0,0, -L/2);
      pos2[4] = new THREE.Vector3(0,0, -L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(0,-L, L/2);
      pos2[5] = new THREE.Vector3(0,-L, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[2][14].visible = false;
    people[4][11].visible = true;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupC.children[4].visible = true;
    GroupE.children[6].visible = false;
  	if (GroupD.children[0].position.z>0){
  		
      if(GroupA.children[0].rotation.z < Math.PI + Math.PI/2){
      	GroupA.children[0].rotation.z += 0.05;
      	GroupB.children[0].rotation.y -= 0.05;
        GroupC.children[0].rotation.z -= 0.05;
        GroupD.children[0].rotation.y -= 0.05;
        GroupE.children[0].rotation.y -= 0.05;
        GroupF.children[0].rotation.y -= 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.z>=-L/2+L/kk){
      	people[0][13].visible = true;
        people[1][13].visible = true;
        people[2][14].visible = true;
        people[4][11].visible = true;
      }
      GroupA.children[0].position.y += triStep;
      GroupB.children[0].position.z += triStep;
      GroupC.children[0].position.y -= triStep;
      GroupD.children[0].position.z += triStep;
      GroupE.children[0].position.z += triStep;
      GroupF.children[0].position.z -= triStep;
    }
  }
}
function CtoA(){
	var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.y<Math.PI){
      GroupA.children[0].rotation.y += 0.05;
      GroupB.children[0].rotation.z -= 0.05;
      GroupC.children[0].rotation.y += 0.05;
      GroupD.children[0].rotation.z -= 0.05;
      GroupE.children[0].rotation.z -= 0.05;
      GroupF.children[0].rotation.z += 0.05;
    }
    else{
      GroupA.children[0].position.x += triStep;
      GroupB.children[0].position.y += triStep;
      GroupC.children[0].position.x += triStep;
      GroupD.children[0].position.y -= triStep;
      GroupE.children[0].position.x += triStep;
      GroupF.children[0].position.x += triStep;
    }
  	if (GroupA.children[0].position.x > L/2-L/kk) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2-L/kk,-L, 0);
      pos2[0] = new THREE.Vector3(L/2,-L, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0,-L/kk, -L/2);
      pos2[1] = new THREE.Vector3(0,0, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2-L/kk,0, 0);
      pos2[2] = new THREE.Vector3(L/2,0, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L+L/kk, -L/2);
      pos2[3] = new THREE.Vector3(0,-L, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2-L/kk,-L/2, -L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2-L/kk,-L/2, L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1){ // in crossing
  	people[2][14].visible = false;
    people[1][13].visible = false;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } 
  else if(turning === 2){ 
  	if (GroupD.children[0].position.z<L/2){
      GroupC.children[4].visible = true;
      GroupB.children[4].visible = false;
    	if(GroupD.children[0].position.z>=-L/2+L/kk)people[1][13].visible = true;
      GroupA.children[0].position.y += triStep;
      GroupB.children[0].position.z += triStep;
      GroupC.children[0].position.y -= triStep;
      GroupD.children[0].position.z += triStep;
      GroupE.children[0].position.z += triStep;
      GroupF.children[0].position.z -= triStep;
    }
    else if (GroupD.children[0].position.z>L/2) {
    	if(change == 0){
        euler1[0] = new THREE.Euler (0,Math.PI, -Math.PI/2, 'ZYX');
        euler2[0] = new THREE.Euler (0,Math.PI, 0, 'ZYX');

        euler1[1] = new THREE.Euler (0,-Math.PI/2, 0, 'ZYX');
        euler2[1] = new THREE.Euler (Math.PI/2,0, -Math.PI/2, 'ZYX');

        euler1[2] = new THREE.Euler (0, 0, -Math.PI/2, 'ZYX');
        euler2[2] = new THREE.Euler (0, 0, -Math.PI, 'ZYX');

        euler1[3] = new THREE.Euler (0, -Math.PI/2, Math.PI, 'ZYX');
        euler2[3] = new THREE.Euler (Math.PI/2, 0, Math.PI/2, 'ZYX');

        euler1[4] = new THREE.Euler (0, -Math.PI/2, -Math.PI/2, 'ZYX');
        euler2[4] = new THREE.Euler (Math.PI/2, 0, -Math.PI, 'ZYX');

        euler1[5] = new THREE.Euler (0, Math.PI/2, -Math.PI/2, 'ZYX');
        euler2[5] = new THREE.Euler (-Math.PI/2, 0, Math.PI, 'ZYX');
        change = 1;
      }
      turning = 3;
      pos1[0] = new THREE.Vector3(L/2, 0, 0);
      pos2[0] = new THREE.Vector3(L/2, 0, 0);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(0, 0, L/2);
      pos2[1] = new THREE.Vector3(0, 0, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2,-L, 0);
      pos2[2] = new THREE.Vector3(L/2,-L, 0);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(0,-L, L/2);
      pos2[3] = new THREE.Vector3(0,-L, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[4] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[5] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  
		else {
      GroupB.children[4].visible = true;
      GroupA.children[5].visible = false;
    	if (GroupD.children[0].position.y>-L/2){
        if(GroupA.children[0].rotation.y>Math.PI/2){
          
          GroupA.children[0].rotation.y -= 0.05;
          GroupB.children[0].rotation.z -= 0.05;
          GroupC.children[0].rotation.y -= 0.05;
          GroupD.children[0].rotation.z -= 0.05;
          GroupE.children[0].rotation.z -= 0.05;
          GroupF.children[0].rotation.z += 0.05;
         }
        else moving = false;
    	}
      else{
      	if(GroupD.children[0].position.y>=-L+L/kk)people[0][13].visible = true;
        GroupA.children[0].position.x -= triStep;
        GroupB.children[0].position.y -= triStep;
        GroupC.children[0].position.x -= triStep;
        GroupD.children[0].position.y += triStep;
        GroupE.children[0].position.x -= triStep;
        GroupF.children[0].position.x -= triStep;
      }
    }
  }
  else if (turning === 3) { // in crossing
  	people[1][13].visible = false;
    people[0][13].visible = false;
  	alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  }
}

function EtoA() {
var triStep = .90;
  if (turning === 0) {
  	if(GroupA.children[0].rotation.z <Math.PI/2){
      GroupA.children[0].rotation.z += 0.05;
      GroupB.children[0].rotation.y -= 0.05;
      GroupC.children[0].rotation.z -= 0.05;
      GroupD.children[0].rotation.y -= 0.05;
      GroupE.children[0].rotation.y -= 0.05;
      GroupF.children[0].rotation.y -= 0.05;
    }
    else{
      GroupA.children[0].position.y += triStep;
      GroupB.children[0].position.z += triStep;
      GroupC.children[0].position.y -= triStep;
      GroupD.children[0].position.z += triStep;
      GroupE.children[0].position.z += triStep;
      GroupF.children[0].position.z -= triStep;
    }
  	if (GroupD.children[0].position.z>L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(0,0, -L/2);
      pos2[0] = new THREE.Vector3(0,0, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(-L/2,-L/2, L/2);
      pos2[1] = new THREE.Vector3(-L/2,-L/2, L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(0,-L, L/2);
      pos2[2] = new THREE.Vector3(0,-L, L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[3] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(0,0,L/2);
      pos2[4] = new THREE.Vector3(0,0,L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(0,-L, -L/2);
      pos2[5] = new THREE.Vector3(0,-L, -L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[4][11].visible = false;
    people[0][13].visible = false;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupE.children[6].visible = true;
    GroupA.children[5].visible = false;
  	if (GroupD.children[0].position.x<0){
  		
      if(GroupA.children[0].rotation.y < Math.PI/2){
      	
      	GroupA.children[0].rotation.y += 0.05;
      	GroupB.children[0].rotation.z += 0.05;
        GroupC.children[0].rotation.y += 0.05;
        GroupD.children[0].rotation.z += 0.05;
        GroupE.children[0].rotation.z += 0.05;
        GroupF.children[0].rotation.z -= 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.x<=L/2-L/kk)people[0][13].visible = true;
      GroupA.children[0].position.z += triStep;
      GroupB.children[0].position.x += triStep;
      GroupC.children[0].position.z -= triStep;
      GroupD.children[0].position.x -= triStep;
      GroupE.children[0].position.y -= triStep;
      GroupF.children[0].position.y += triStep;
    }
  }
}
function EtoC() {
var triStep = .90;
  if (turning === 0) {
  	GroupA.children[0].position.y -= triStep;
  	GroupB.children[0].position.z -= triStep;
    GroupC.children[0].position.y += triStep;
  	GroupD.children[0].position.z -= triStep;
    GroupE.children[0].position.z -= triStep;
  	GroupF.children[0].position.z += triStep;
  	if (GroupD.children[0].position.z < -L/2) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(0,-L, -L/2);
      pos2[0] = new THREE.Vector3(0,-L, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(-L/2,-L/2, -L/2);
      pos2[1] = new THREE.Vector3(-L/2,-L/2, -L/2);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(0,0, L/2);
      pos2[2] = new THREE.Vector3(0,0, L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[3] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(0,0,-L/2);
      pos2[4] = new THREE.Vector3(0,0,-L/2);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(0,-L, L/2);
      pos2[5] = new THREE.Vector3(0,-L, L/2);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[4][11].visible = false;
    people[2][14].visible = true;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupE.children[6].visible = true;
    GroupC.children[4].visible = false;
  	if (GroupD.children[0].position.x<0){
  		
      if(GroupA.children[0].rotation.y > -Math.PI/2-Math.PI){
      	GroupA.children[0].rotation.y -= 0.05;
      	GroupB.children[0].rotation.z -= 0.05;
        GroupC.children[0].rotation.y += 0.05;
        GroupD.children[0].rotation.z -= 0.05;
        GroupE.children[0].rotation.z -= 0.05;
        GroupF.children[0].rotation.z += 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.x<=L/2-L/kk)people[2][14].visible = true;
      GroupA.children[0].position.z += triStep;
      GroupB.children[0].position.x += triStep;
      GroupC.children[0].position.z -= triStep;
      GroupD.children[0].position.x -= triStep;
      GroupE.children[0].position.y -= triStep;
      GroupF.children[0].position.y += triStep;
    }
  }
}
function EtoB() {
var triStep = .90;
  if (turning === 0) {
    if(GroupA.children[0].rotation.z < 0){
      GroupA.children[0].rotation.z += 0.05;
      GroupB.children[0].rotation.y -= 0.05;
      GroupC.children[0].rotation.z -= 0.05;
      GroupD.children[0].rotation.y -= 0.05;
      GroupE.children[0].rotation.y -= 0.05;
      GroupF.children[0].rotation.y -= 0.05;
    }
    else{
      GroupA.children[0].position.x += triStep;
      GroupB.children[0].position.y += triStep;
      GroupC.children[0].position.x += triStep;
      GroupD.children[0].position.y -= triStep;
      GroupE.children[0].position.x += triStep;
      GroupF.children[0].position.x += triStep;
    }
  	if (GroupD.children[0].position.y<-L) {// ready to cross
      turning = 1;
      pos1[0] = new THREE.Vector3(L/2,-L/2, -L/2);
      pos2[0] = new THREE.Vector3(L/2,-L/2, -L/2);
      quat1[0] = new THREE.Quaternion();
      quat1[0].setFromEuler(euler1[0]);
      quat2[0] = new THREE.Quaternion();
      quat2[0].setFromEuler(euler2[0]);
      ///////////////////
      pos1[1] = new THREE.Vector3(-L/2,0, 0);
      pos2[1] = new THREE.Vector3(-L/2,0, 0);
      quat1[1] = new THREE.Quaternion();
      quat1[1].setFromEuler(euler1[1]);
      quat2[1] = new THREE.Quaternion();
      quat2[1].setFromEuler(euler2[1]);
      ///////////////////
      pos1[2] = new THREE.Vector3(L/2,-L/2, L/2);
      pos2[2] = new THREE.Vector3(L/2,-L/2, L/2);
      quat1[2] = new THREE.Quaternion();
      quat1[2].setFromEuler(euler1[2]);
      quat2[2] = new THREE.Quaternion();
      quat2[2].setFromEuler(euler2[2]);
      ///////////////////
      pos1[3] = new THREE.Vector3(L/2,-L, 0);
      pos2[3] = new THREE.Vector3(L/2,-L, 0);
      quat1[3] = new THREE.Quaternion();
      quat1[3].setFromEuler(euler1[3]);
      quat2[3] = new THREE.Quaternion();
      quat2[3].setFromEuler(euler2[3]);
      ///////////////////
      pos1[4] = new THREE.Vector3(L/2,0, 0);
      pos2[4] = new THREE.Vector3(L/2,0, 0);
      quat1[4] = new THREE.Quaternion();
      quat1[4].setFromEuler(euler1[4]);
      quat2[4] = new THREE.Quaternion();
      quat2[4].setFromEuler(euler2[4]);
      ///////////////////
      pos1[5] = new THREE.Vector3(L/2,-L, 0);
      pos2[5] = new THREE.Vector3(L/2,-L, 0);
      quat1[5] = new THREE.Quaternion();
      quat1[5].setFromEuler(euler1[5]);
      quat2[5] = new THREE.Quaternion();
      quat2[5].setFromEuler(euler2[5]);
      ///////////////////
      alpha[0] = 0;
      alpha[1] = 0;
      alpha[2] = 0;
      alpha[3] = 0;
      alpha[4] = 0;
      alpha[5] = 0;
    }  

  } else if (turning === 1) { // in crossing
  	people[4][11].visible = false;
    people[1][13].visible = false;
    alpha[0] = Cross(GroupA,pos1[0],pos2[0],quat1[0],quat2[0],alpha[0]);
    alpha[1] = Cross(GroupB,pos1[1],pos2[1],quat1[1],quat2[1],alpha[1]);
    alpha[2] = Cross(GroupC,pos1[2],pos2[2],quat1[2],quat2[2],alpha[2]);
    alpha[3] = Cross(GroupD,pos1[3],pos2[3],quat1[3],quat2[3],alpha[3]);
    alpha[4] = Cross(GroupE,pos1[4],pos2[4],quat1[4],quat2[4],alpha[4]);
    alpha[5] = Cross(GroupF,pos1[5],pos2[5],quat1[5],quat2[5],alpha[5]);
    GroupA.children[0].position.copy(pos2[0])
    GroupA.children[0].rotation.copy(euler2[0])
    GroupB.children[0].position.copy(pos2[1])
    GroupB.children[0].rotation.copy(euler2[1])
    GroupC.children[0].position.copy(pos2[2])
    GroupC.children[0].rotation.copy(euler2[2])
    GroupD.children[0].position.copy(pos2[3])
    GroupD.children[0].rotation.copy(euler2[3])
    GroupE.children[0].position.copy(pos2[4])
    GroupE.children[0].rotation.copy(euler2[4])
    GroupF.children[0].position.copy(pos2[5])
    GroupF.children[0].rotation.copy(euler2[5])// update alpha
  } else { // turning == 2: finish crossing ... always a straight line
    GroupE.children[6].visible = true;
    GroupB.children[4].visible = false;
  	if (GroupD.children[0].position.x<0){
  		
      if(GroupA.children[0].rotation.y < Math.PI/2){
      	GroupA.children[0].rotation.y += 0.05;
      	GroupB.children[0].rotation.y += 0.05;
        GroupC.children[0].rotation.y += 0.05;
        GroupD.children[0].rotation.y += 0.05;
        GroupE.children[0].rotation.y += 0.05;
        GroupF.children[0].rotation.y += 0.05;
      }
      else moving = false;
    }
    else{
    	if(GroupD.children[0].position.x<=L/2-L/kk)people[1][13].visible = true;
      GroupA.children[0].position.z += triStep;
      GroupB.children[0].position.x += triStep;
      GroupC.children[0].position.z -= triStep;
      GroupD.children[0].position.x -= triStep;
      GroupE.children[0].position.y -= triStep;
      GroupF.children[0].position.y += triStep;
    }
  }
}

function Cross(Group,pos1,pos2,quat1,quat2,alpha){
  alpha += 0.01;
    
  var qm = quat1.clone().slerp(quat2, alpha);
  Group.children[0].matrix.makeRotationFromQuaternion (qm);
  
  var pp = pos1.clone().lerp(pos2, alpha);
  Group.children[0].matrix.setPosition(pp);
  Group.children[0].matrixAutoUpdate = false;
  
  if (alpha > 1.0) {
  	turning = 2; // done turning
    
    Group.children[0].position.setFromMatrixPosition (Group.children[0].matrixWorld);
    Group.children[0].quaternion.setFromRotationMatrix (Group.children[0].matrixWorld); 
    
    Group.children[0].matrixAutoUpdate = true;
  }
  return alpha;
}
function render() {

  renderer.render(scene, camera);

}
</script>
</body>

</html>